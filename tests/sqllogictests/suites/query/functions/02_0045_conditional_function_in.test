query I
SELECT number from numbers_mt(10) WHERE number+1 IN (2, 3 ,20) ORDER BY number
----
1
2

query I
SELECT number from numbers_mt(10000) WHERE number+1 IN (2, 3 ,20, 5000) ORDER BY number
----
1
2
19
4999

query II
select number from numbers(10) where number::String  in (1,2) ORDER BY number
----
1
2


query I
SELECT number from numbers_mt(10) WHERE number+1 not IN (2, 3 ,20, 5000) ORDER BY number
----
0
3
4
5
6
7
8
9

query T
SELECT NULL IN (1, 2, 3)
----
NULL

query BB
SELECT 1 IN (1, 2, NULL), (true IN (false, (NULL NOT BETWEEN NULL AND NULL)))
----
1 NULL


query BB
SELECT 1::Int64 IN (0,10,1.1), 0::Float32 IN (0, 10, 1.1)
----
0 1

query B
SELECT 1 IN (2, 3, NULL)
----
NULL

query B
select if(number > 1000, 3, null) in (1,2,3) from numbers(3)
----
NULL
NULL
NULL



query B
SELECT 1.1 IN (1.10, 2, 3.3, 1.1)
----
1

statement ok
SELECT * FROM system.one a INNER JOIN system.one b ON 1 IN ( 1, NULL) WHERE FALSE


query B
select 1 in (1.2, 2)
----
0



query B
select 1 in (1.0, 2)
----
1



query B
select 'aa' in ('aa', 'bb', 'cc')
----
1



query B
select true in (true, false)
----
1



query B
select true in (NULL, false)
----
NULL



query B
SELECT to_date(18869) in (to_date(18869))
----
1



query B
SELECT to_date(18869) in ('2021-08-30'::Date)
----
1



query B
SELECT to_date(18869) in (to_date(18869), NULL)
----
1



query T
SELECT NULL in ('2021-08-30')
----
NULL

statement ok
DROP TABLE IF EXISTS t1

statement ok
CREATE TABLE t1(a UInt64 null, b UInt64 null) Engine = Fuse

statement ok
INSERT INTO t1 (a,b) VALUES (1, NULL), (2, 3)

query I
SELECT a FROM t1 WHERE b IN (NULL,3)
----
2

query I
SELECT a FROM t1 WHERE a IN (a, b) ORDER BY a
----
1
2

query I
SELECT a FROM t1 WHERE a + 1 IN (a + 1, 3) ORDER BY a
----
1
2


query I
SELECT a FROM t1 WHERE a IN (select a from t1) and b is not null
----
2

statement ok
DROP TABLE t1

statement ok
DROP TABLE IF EXISTS t2

statement ok
CREATE TABLE t2(date DATE, datetime DATETIME null) Engine = Fuse

statement ok
INSERT INTO t2 VALUES ('2022-04-23', '2022-04-23 01:48:19'), ('2022-04-24', NULL)

query TT
SELECT * FROM t2 WHERE date in ('2022-04-23'::Date)
----
2022-04-23 2022-04-23 01:48:19.000000

query TT
SELECT * FROM t2 WHERE datetime in ('2022-04-23 01:48:19'::TIMESTAMP, NULL)
----
2022-04-23 2022-04-23 01:48:19.000000

statement ok
DROP TABLE t2


statement ok
create table t1 as values(1), (2), (3);

query I rowsort
select * from t1 where t1.col0 in (1,1,1,1,222, 33, 2, 1);
----
1
2

statement ok
drop table t1;
