statement ok
drop table if exists t1 all

statement ok
create table t1(a integer null, b integer null, c integer null, d integer null, e integer null)

statement ok
insert into t1(e,c,b,d,a) values(null,102,null,101,104)

statement ok
insert into t1(a,c,d,e,b) values(107,106,108,109,105)

statement ok
insert into t1(e,d,b,a,c) values(110,114,112,null,113)

statement ok
insert into t1(d,c,e,a,b) values(116,119,117,115,null)

statement ok
insert into t1(c,d,b,e,a) values(123,122,124,null,121)

statement ok
insert into t1(a,d,b,e,c) values(127,128,129,126,125)

statement ok
insert into t1(e,c,a,d,b) values(132,134,131,133,130)

statement ok
insert into t1(a,d,b,e,c) values(138,136,139,135,137)

statement ok
insert into t1(e,c,d,a,b) values(144,141,140,142,143)

statement ok
insert into t1(b,a,e,d,c) values(145,149,146,null,147)

statement ok
insert into t1(b,c,a,d,e) values(151,150,153,null,null)

statement ok
insert into t1(c,e,a,d,b) values(155,157,159,null,158)

statement ok
insert into t1(c,b,a,d,e) values(161,160,163,164,162)

statement ok
insert into t1(b,d,a,e,c) values(167,null,168,165,166)

statement ok
insert into t1(d,b,c,e,a) values(171,170,172,173,174)

statement ok
insert into t1(e,c,a,d,b) values(177,176,179,null,175)

statement ok
insert into t1(b,e,a,d,c) values(181,180,182,183,184)

statement ok
insert into t1(c,a,b,e,d) values(187,188,186,189,185)

statement ok
insert into t1(d,b,c,e,a) values(190,194,193,192,191)

statement ok
insert into t1(a,e,b,d,c) values(199,197,198,196,195)

statement ok
insert into t1(b,c,d,a,e) values(null,202,203,201,204)

statement ok
insert into t1(c,e,a,b,d) values(208,null,null,206,207)

statement ok
insert into t1(c,e,a,d,b) values(214,210,213,212,211)

statement ok
insert into t1(b,c,a,d,e) values(218,215,216,217,219)

statement ok
insert into t1(b,e,d,a,c) values(223,221,222,220,224)

statement ok
insert into t1(d,e,b,a,c) values(226,227,228,229,225)

statement ok
insert into t1(a,c,b,e,d) values(234,231,232,230,233)

statement ok
insert into t1(e,b,a,c,d) values(237,236,239,null,238)

statement ok
insert into t1(e,c,b,a,d) values(null,244,240,243,null)

statement ok
insert into t1(e,d,c,b,a) values(246,248,247,249,245)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       b-c as col3,
       abs(b-c) as col4,
       abs(a) as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6,
       a+b*2 as col7
from t1
order by col7,col4,col6,col2,col3,col1,col5

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1
from t1
where c>d
    or (e>c or e<d)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1
from t1
where c>d
    or (e>c or e<d)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1
from t1
where (e>c or e<d)
    or c>d
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1
from t1
where (e>c or e<d)
    or c>d
order by col1

query I
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1
from t1
order by col1
----
111
111
222
222
222
333
333
333
333
333
333
333
444
444
444
444
444
555
555
555
555
555
555
555
555
555
555
555
555
555

query I
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1
from t1
order by col1
----
111
111
222
222
222
333
333
333
333
333
333
333
444
444
444
444
444
555
555
555
555
555
555
555
555
555
555
555
555
555

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       (a+b+c+d+e)/5 as col3,
       b-c as col4,
       c as col5
from t1
where (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       (a+b+c+d+e)/5 as col3,
       b-c as col4,
       c as col5
from t1
where (c<=d-2 or c>=d+2)
order by col5,col1,col4,col3,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where b>c
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where b>c
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       b as col2,
       b-c as col3
from t1
where (c<=d-2 or c>=d+2)
   and (a>b-2 and a<b+2)
   and c between b-2 and d+2
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       b as col2,
       b-c as col3
from t1
where (c<=d-2 or c>=d+2)
   and (a>b-2 and a<b+2)
   and c between b-2 and d+2
order by col2,col1,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       b as col2,
       b-c as col3
from t1
where (c<=d-2 or c>=d+2)
   and c between b-2 and d+2
   and (a>b-2 and a<b+2)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       b as col2,
       b-c as col3
from t1
where (c<=d-2 or c>=d+2)
   and c between b-2 and d+2
   and (a>b-2 and a<b+2)
order by col1,col3,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       a-b as col5
from t1
where d not between 110 and 150
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       a-b as col5
from t1
where d not between 110 and 150
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col5,col1,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       d as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       d-e as col6,
       c-d as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       d as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       d-e as col6,
       c-d as col7
from t1
order by col5,col7,col3,col1,col6,col4,col2

query TI
select d-e as col1,
       abs(a) as col2
from t1
order by col2,col1
----
NULL 104
-1 107
-1 115
NULL 121
2 127
1 131
1 138
-4 142
NULL 149
NULL 153
NULL 159
2 163
NULL 168
-2 174
NULL 179
3 182
-4 188
-2 191
-1 199
-1 201
2 213
-2 216
1 220
-1 229
3 234
1 239
NULL 243
2 245
4 NULL
NULL NULL

query TI
select d-e as col1,
       abs(a) as col2
from t1
order by col2,col1
----
NULL 104
-1 107
-1 115
NULL 121
2 127
1 131
1 138
-4 142
NULL 149
NULL 153
NULL 159
2 163
NULL 168
-2 174
NULL 179
3 182
-4 188
-2 191
-1 199
-1 201
2 213
-2 216
1 220
-1 229
3 234
1 239
NULL 243
2 245
4 NULL
NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       abs(b-c) as col2,
       d-e as col3,
       d as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where e+d between a+b-10 and c+130
    or a>b
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       abs(b-c) as col2,
       d-e as col3,
       d as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where e+d between a+b-10 and c+130
    or a>b
order by col2,col3,col4,col5,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       abs(b-c) as col2,
       d-e as col3,
       d as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where a>b
    or e+d between a+b-10 and c+130
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       abs(b-c) as col2,
       d-e as col3,
       d as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where a>b
    or e+d between a+b-10 and c+130
order by col2,col4,col5,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       a+b*2+c*3 as col2,
       a+b*2 as col3,
       c-d as col4,
       (a+b+c+d+e)/5 as col5,
       a-b as col6
from t1
where e+d between a+b-10 and c+130
   and d>e
   and d not between 110 and 150
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       a+b*2+c*3 as col2,
       a+b*2 as col3,
       c-d as col4,
       (a+b+c+d+e)/5 as col5,
       a-b as col6
from t1
where e+d between a+b-10 and c+130
   and d>e
   and d not between 110 and 150
order by col2,col1,col5,col3,col6,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       a+b*2+c*3 as col2,
       a+b*2 as col3,
       c-d as col4,
       (a+b+c+d+e)/5 as col5,
       a-b as col6
from t1
where d not between 110 and 150
   and e+d between a+b-10 and c+130
   and d>e
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       a+b*2+c*3 as col2,
       a+b*2 as col3,
       c-d as col4,
       (a+b+c+d+e)/5 as col5,
       a-b as col6
from t1
where d not between 110 and 150
   and e+d between a+b-10 and c+130
   and d>e
order by col1,col4,col3,col5,col6,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       a+b*2+c*3 as col2,
       a+b*2 as col3,
       c-d as col4,
       (a+b+c+d+e)/5 as col5,
       a-b as col6
from t1
where d>e
   and e+d between a+b-10 and c+130
   and d not between 110 and 150
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       a+b*2+c*3 as col2,
       a+b*2 as col3,
       c-d as col4,
       (a+b+c+d+e)/5 as col5,
       a-b as col6
from t1
where d>e
   and e+d between a+b-10 and c+130
   and d not between 110 and 150
order by col3,col6,col5,col2,col4,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       a+b*2+c*3 as col2,
       a+b*2 as col3,
       c-d as col4,
       (a+b+c+d+e)/5 as col5,
       a-b as col6
from t1
where d not between 110 and 150
   and d>e
   and e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       a+b*2+c*3 as col2,
       a+b*2 as col3,
       c-d as col4,
       (a+b+c+d+e)/5 as col5,
       a-b as col6
from t1
where d not between 110 and 150
   and d>e
   and e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1

query TIT
select b as col1,
       abs(a) as col2,
       a+b*2+c*3+d*4+e*5 as col3
from t1
order by col2,col3,col1
----
NULL 104 NULL
105 107 1612
NULL 115 NULL
124 121 NULL
129 127 1902
130 131 1985
139 138 2046
143 142 2131
145 149 NULL
151 153 NULL
158 159 NULL
160 163 2432
167 168 NULL
170 174 2579
175 179 NULL
181 182 2728
186 188 2806
194 191 2878
198 199 2949
NULL 201 NULL
211 213 3175
218 216 3260
223 220 3331
228 229 3399
232 234 3473
236 239 NULL
240 243 NULL
249 245 3706
112 NULL NULL
206 NULL NULL

query TIT
select b as col1,
       abs(a) as col2,
       a+b*2+c*3+d*4+e*5 as col3
from t1
order by col2,col3,col1
----
NULL 104 NULL
105 107 1612
NULL 115 NULL
124 121 NULL
129 127 1902
130 131 1985
139 138 2046
143 142 2131
145 149 NULL
151 153 NULL
158 159 NULL
160 163 2432
167 168 NULL
170 174 2579
175 179 NULL
181 182 2728
186 188 2806
194 191 2878
198 199 2949
NULL 201 NULL
211 213 3175
218 216 3260
223 220 3331
228 229 3399
232 234 3473
236 239 NULL
240 243 NULL
249 245 3706
112 NULL NULL
206 NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       e as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4,
       a-b as col5
from t1
where c>d
   and b>c
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       e as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4,
       a-b as col5
from t1
where c>d
   and b>c
order by col1,col4,col3,col2,col5

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       e as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4,
       a-b as col5
from t1
where b>c
   and c>d
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       e as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4,
       a-b as col5
from t1
where b>c
   and c>d
order by col1,col3,col4,col5,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2 as col2
from t1
where d not between 110 and 150
    or b>c
    or c between b-2 and d+2
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2 as col2
from t1
where d not between 110 and 150
    or b>c
    or c between b-2 and d+2
order by col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2 as col2
from t1
where c between b-2 and d+2
    or d not between 110 and 150
    or b>c
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2 as col2
from t1
where c between b-2 and d+2
    or d not between 110 and 150
    or b>c
order by col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2 as col2
from t1
where c between b-2 and d+2
    or b>c
    or d not between 110 and 150
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2 as col2
from t1
where c between b-2 and d+2
    or b>c
    or d not between 110 and 150
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2 as col2
from t1
where d not between 110 and 150
    or c between b-2 and d+2
    or b>c
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2 as col2
from t1
where d not between 110 and 150
    or c between b-2 and d+2
    or b>c
order by col1,col2

query IIFI
select case when c>avg_c then a*2 else b*10 end as col1,
       c-d as col2,
       (a+b+c+d+e)/5 as col3,
       d as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
   and d not between 110 and 150
order by col4,col2,col3,col1
----
1050 -2 107.0 108
1600 -3 162.0 164
1700 1 172.0 171
364 1 182.0 183
376 2 187.0 185
398 -1 197.0 196
402 -1 NULL 203
426 2 212.0 212
432 -2 217.0 217
440 2 222.0 222
458 -1 227.0 226
468 -2 232.0 233
2360 NULL NULL 238
490 -1 247.0 248

query IIFI
select case when c>avg_c then a*2 else b*10 end as col1,
       c-d as col2,
       (a+b+c+d+e)/5 as col3,
       d as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
   and d not between 110 and 150
order by col3,col2,col4,col1
----
1050 -2 107.0 108
1600 -3 162.0 164
1700 1 172.0 171
364 1 182.0 183
376 2 187.0 185
398 -1 197.0 196
426 2 212.0 212
432 -2 217.0 217
440 2 222.0 222
458 -1 227.0 226
468 -2 232.0 233
490 -1 247.0 248
402 -1 NULL 203
2360 NULL NULL 238

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where (e>c or e<d)
   and a>b
   and d not between 110 and 150
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where (e>c or e<d)
   and a>b
   and d not between 110 and 150
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where (e>c or e<d)
   and d not between 110 and 150
   and a>b
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where (e>c or e<d)
   and d not between 110 and 150
   and a>b
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where a>b
   and (e>c or e<d)
   and d not between 110 and 150
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where a>b
   and (e>c or e<d)
   and d not between 110 and 150
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       c-d as col2,
       c as col3,
       b as col4,
       e as col5,
       a+b*2+c*3+d*4 as col6
from t1
where c>d
   and e+d between a+b-10 and c+130
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       c-d as col2,
       c as col3,
       b as col4,
       e as col5,
       a+b*2+c*3+d*4 as col6
from t1
where c>d
   and e+d between a+b-10 and c+130
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col4,col3,col5,col2,col6

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       c-d as col2,
       c as col3,
       b as col4,
       e as col5,
       a+b*2+c*3+d*4 as col6
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and c>d
   and e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       c-d as col2,
       c as col3,
       b as col4,
       e as col5,
       a+b*2+c*3+d*4 as col6
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and c>d
   and e+d between a+b-10 and c+130
order by col1,col6,col4,col5,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       c-d as col2,
       c as col3,
       b as col4,
       e as col5,
       a+b*2+c*3+d*4 as col6
from t1
where e+d between a+b-10 and c+130
   and c>d
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       c-d as col2,
       c as col3,
       b as col4,
       e as col5,
       a+b*2+c*3+d*4 as col6
from t1
where e+d between a+b-10 and c+130
   and c>d
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col2,col1,col6,col5,col3

query II
select d-e as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (a>b-2 and a<b+2)
   and (e>c or e<d)
   and c>d
order by col2,col1
----
3 364
1 1300
1 1390
-4 1430

query II
select d-e as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (a>b-2 and a<b+2)
   and (e>c or e<d)
   and c>d
order by col2,col1
----
3 364
1 1300
1 1390
-4 1430

query II
select d-e as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
   and c>d
   and (a>b-2 and a<b+2)
order by col2,col1
----
3 364
1 1300
1 1390
-4 1430

query II
select d-e as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
   and c>d
   and (a>b-2 and a<b+2)
order by col1,col2
----
-4 1430
1 1300
1 1390
3 364

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a+b*2+c*3+d*4 as col3
from t1
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a+b*2+c*3+d*4 as col3
from t1
order by col3,col1,col2

query II
select d-e as col1,
       b as col2
from t1
order by col2,col1
----
-1 105
4 112
NULL 124
2 129
1 130
1 139
-4 143
NULL 145
NULL 151
NULL 158
2 160
NULL 167
-2 170
NULL 175
3 181
-4 186
-2 194
-1 198
NULL 206
2 211
-2 218
1 223
-1 228
3 232
1 236
NULL 240
2 249
-1 NULL
-1 NULL
NULL NULL

query II
select d-e as col1,
       b as col2
from t1
order by col2,col1
----
-1 105
4 112
NULL 124
2 129
1 130
1 139
-4 143
NULL 145
NULL 151
NULL 158
2 160
NULL 167
-2 170
NULL 175
3 181
-4 186
-2 194
-1 198
NULL 206
2 211
-2 218
1 223
-1 228
3 232
1 236
NULL 240
2 249
-1 NULL
-1 NULL
NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       abs(a) as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4,
       a as col5
from t1
where a>b
   and c>d
   and c between b-2 and d+2
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       abs(a) as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4,
       a as col5
from t1
where a>b
   and c>d
   and c between b-2 and d+2
order by col3,col1,col5,col2,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       abs(a) as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4,
       a as col5
from t1
where a>b
   and c between b-2 and d+2
   and c>d
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       abs(a) as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4,
       a as col5
from t1
where a>b
   and c between b-2 and d+2
   and c>d
order by col3,col1,col5,col2,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       abs(a) as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4,
       a as col5
from t1
where c between b-2 and d+2
   and a>b
   and c>d
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       abs(a) as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4,
       a as col5
from t1
where c between b-2 and d+2
   and a>b
   and c>d
order by col5,col1,col4,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       abs(a) as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4,
       a as col5
from t1
where c>d
   and c between b-2 and d+2
   and a>b
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       abs(a) as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4,
       a as col5
from t1
where c>d
   and c between b-2 and d+2
   and a>b
order by col4,col1,col3,col5,col2

query I
select d-e as col1
from t1
order by col1
----
-4
-4
-2
-2
-2
-1
-1
-1
-1
-1
1
1
1
1
2
2
2
2
3
3
4
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I
select d-e as col1
from t1
order by col1
----
-4
-4
-2
-2
-2
-1
-1
-1
-1
-1
1
1
1
1
2
2
2
2
3
3
4
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query ITTIT
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       b-c as col2,
       a+b*2+c*3+d*4 as col3,
       a as col4,
       abs(b-c) as col5
from t1
order by col4,col5,col2,col3,col1
----
444 NULL NULL 104 NULL
333 -1 1067 107 1
444 NULL NULL 115 NULL
222 1 1226 121 1
222 4 1272 127 4
333 -4 1325 131 4
222 2 1371 138 2
222 2 1411 142 2
444 -2 NULL 149 2
333 1 NULL 153 1
333 3 NULL 159 3
444 -1 1622 163 1
333 1 NULL 168 1
444 -2 1714 174 2
444 -1 NULL 179 1
333 -3 1828 182 3
333 -1 1861 188 1
222 1 1918 191 1
333 3 1964 199 3
444 NULL NULL 201 NULL
333 -3 2125 213 3
222 3 2165 216 3
222 -1 2226 220 1
333 3 2264 229 3
333 1 2323 234 1
444 NULL NULL 239 NULL
444 -4 NULL 243 4
111 2 2476 245 2
444 -1 NULL NULL 1
444 -2 NULL NULL 2

query IIIII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       b-c as col2,
       a+b*2+c*3+d*4 as col3,
       a as col4,
       abs(b-c) as col5
from t1
order by col2,col4,col1,col5,col3
----
333 -4 1325 131 4
444 -4 NULL 243 4
333 -3 1828 182 3
333 -3 2125 213 3
444 -2 NULL 149 2
444 -2 1714 174 2
444 -2 NULL NULL 2
333 -1 1067 107 1
444 -1 1622 163 1
444 -1 NULL 179 1
333 -1 1861 188 1
222 -1 2226 220 1
444 -1 NULL NULL 1
222 1 1226 121 1
333 1 NULL 153 1
333 1 NULL 168 1
222 1 1918 191 1
333 1 2323 234 1
222 2 1371 138 2
222 2 1411 142 2
111 2 2476 245 2
333 3 NULL 159 3
333 3 1964 199 3
222 3 2165 216 3
333 3 2264 229 3
222 4 1272 127 4
444 NULL NULL 104 NULL
444 NULL NULL 115 NULL
444 NULL NULL 201 NULL
444 NULL NULL 239 NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1
from t1
where d not between 110 and 150
   and (e>a and e<b)
   and (a>b-2 and a<b+2)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1
from t1
where d not between 110 and 150
   and (e>a and e<b)
   and (a>b-2 and a<b+2)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1
from t1
where (a>b-2 and a<b+2)
   and d not between 110 and 150
   and (e>a and e<b)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1
from t1
where (a>b-2 and a<b+2)
   and d not between 110 and 150
   and (e>a and e<b)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select e as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2
from t1
where (e>a and e<b)
    or a>b
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select e as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2
from t1
where (e>a and e<b)
    or a>b
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select e as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2
from t1
where a>b
    or (e>a and e<b)
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select e as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2
from t1
where a>b
    or (e>a and e<b)
order by col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       d-e as col2,
       a+b*2+c*3 as col3,
       abs(b-c) as col4,
       b as col5
from t1
where d>e
    or d not between 110 and 150
    or c>d
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       d-e as col2,
       a+b*2+c*3 as col3,
       abs(b-c) as col4,
       b as col5
from t1
where d>e
    or d not between 110 and 150
    or c>d
order by col4,col1,col5,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       d-e as col2,
       a+b*2+c*3 as col3,
       abs(b-c) as col4,
       b as col5
from t1
where d>e
    or c>d
    or d not between 110 and 150
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       d-e as col2,
       a+b*2+c*3 as col3,
       abs(b-c) as col4,
       b as col5
from t1
where d>e
    or c>d
    or d not between 110 and 150
order by col1,col2,col4,col5,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       d-e as col2,
       a+b*2+c*3 as col3,
       abs(b-c) as col4,
       b as col5
from t1
where c>d
    or d not between 110 and 150
    or d>e
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       d-e as col2,
       a+b*2+c*3 as col3,
       abs(b-c) as col4,
       b as col5
from t1
where c>d
    or d not between 110 and 150
    or d>e
order by col1,col3,col4,col5,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       c as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a as col4,
       a+b*2+c*3+d*4 as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6,
       abs(a) as col7
from t1
where (c<=d-2 or c>=d+2)
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       c as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a as col4,
       a+b*2+c*3+d*4 as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6,
       abs(a) as col7
from t1
where (c<=d-2 or c>=d+2)
order by col4,col1,col5,col2,col6,col3,col7

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2+c*3+d*4 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       abs(b-c) as col5,
       d as col6
from t1
where c between b-2 and d+2
   and (a>b-2 and a<b+2)
   and e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2+c*3+d*4 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       abs(b-c) as col5,
       d as col6
from t1
where c between b-2 and d+2
   and (a>b-2 and a<b+2)
   and e+d between a+b-10 and c+130
order by col3,col2,col6,col4,col5,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2+c*3+d*4 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       abs(b-c) as col5,
       d as col6
from t1
where (a>b-2 and a<b+2)
   and c between b-2 and d+2
   and e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2+c*3+d*4 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       abs(b-c) as col5,
       d as col6
from t1
where (a>b-2 and a<b+2)
   and c between b-2 and d+2
   and e+d between a+b-10 and c+130
order by col5,col6,col2,col3,col1,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2+c*3+d*4 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       abs(b-c) as col5,
       d as col6
from t1
where c between b-2 and d+2
   and e+d between a+b-10 and c+130
   and (a>b-2 and a<b+2)
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2+c*3+d*4 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       abs(b-c) as col5,
       d as col6
from t1
where c between b-2 and d+2
   and e+d between a+b-10 and c+130
   and (a>b-2 and a<b+2)
order by col4,col6,col5,col1,col3,col2

query IIIIII
select d as col1,
       c-d as col2,
       a+b*2+c*3 as col3,
       c as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a+b*2+c*3+d*4+e*5 as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col6,col4,col5,col2,col3,col1
----
108 -2 635 106 1050 1612
128 -3 760 125 1290 1902
133 1 793 134 1300 1985
136 1 827 137 1390 2046
140 1 851 141 1430 2131
164 -3 966 161 1600 2432
171 1 1030 172 1700 2579
183 1 1096 184 364 2728
185 2 1121 187 376 2806
190 3 1158 193 382 2878
196 -1 1180 195 398 2949
212 2 1277 214 426 3175
217 -2 1297 215 432 3260
222 2 1338 224 440 3331
226 -1 1360 225 458 3399
233 -2 1391 231 468 3473
248 -1 1484 247 490 3706
101 1 NULL 102 NULL NULL
114 -1 NULL 113 1120 NULL
116 3 NULL 119 NULL NULL
122 1 738 123 1240 NULL
NULL NULL 880 147 1450 NULL
NULL NULL 905 150 1510 NULL
NULL NULL 940 155 1580 NULL
NULL NULL 1000 166 1670 NULL
NULL NULL 1057 176 358 NULL
203 -1 NULL 202 402 NULL
207 1 NULL 208 NULL NULL
NULL NULL 1455 244 486 NULL
238 NULL NULL NULL 2360 NULL

query IIIIII
select d as col1,
       c-d as col2,
       a+b*2+c*3 as col3,
       c as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a+b*2+c*3+d*4+e*5 as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col2,col5,col6,col3,col1,col4
----
128 -3 760 125 1290 1902
164 -3 966 161 1600 2432
217 -2 1297 215 432 3260
233 -2 1391 231 468 3473
108 -2 635 106 1050 1612
196 -1 1180 195 398 2949
203 -1 NULL 202 402 NULL
226 -1 1360 225 458 3399
248 -1 1484 247 490 3706
114 -1 NULL 113 1120 NULL
183 1 1096 184 364 2728
122 1 738 123 1240 NULL
133 1 793 134 1300 1985
136 1 827 137 1390 2046
140 1 851 141 1430 2131
171 1 1030 172 1700 2579
101 1 NULL 102 NULL NULL
207 1 NULL 208 NULL NULL
185 2 1121 187 376 2806
212 2 1277 214 426 3175
222 2 1338 224 440 3331
190 3 1158 193 382 2878
116 3 NULL 119 NULL NULL
NULL NULL 1057 176 358 NULL
NULL NULL 1455 244 486 NULL
NULL NULL 880 147 1450 NULL
NULL NULL 905 150 1510 NULL
NULL NULL 940 155 1580 NULL
NULL NULL 1000 166 1670 NULL
238 NULL NULL NULL 2360 NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3+d*4 as col3,
       a as col4,
       b as col5,
       c as col6,
       (select count(*) from t1 as x where x.b<t1.b) as col7
from t1
where c>d
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3+d*4 as col3,
       a as col4,
       b as col5,
       c as col6,
       (select count(*) from t1 as x where x.b<t1.b) as col7
from t1
where c>d
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col3,col6,col7,col4,col5,col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3+d*4 as col3,
       a as col4,
       b as col5,
       c as col6,
       (select count(*) from t1 as x where x.b<t1.b) as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or c>d
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3+d*4 as col3,
       a as col4,
       b as col5,
       c as col6,
       (select count(*) from t1 as x where x.b<t1.b) as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or c>d
order by col7,col4,col3,col5,col2,col6,col1

query TTIITIT
select a+b*2+c*3+d*4+e*5 as col1,
       b-c as col2,
       abs(a) as col3,
       d as col4,
       abs(b-c) as col5,
       c as col6,
       d-e as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1
----
NULL NULL 104 101 NULL 102 NULL
1612 -1 107 108 1 106 -1
NULL -1 NULL 114 1 113 4
NULL NULL 115 116 NULL 119 -1
NULL 1 121 122 1 123 NULL
1902 4 127 128 4 125 2
1985 -4 131 133 4 134 1
2046 2 138 136 2 137 1
2131 2 142 140 2 141 -4
NULL -2 149 NULL 2 147 NULL
NULL 1 153 NULL 1 150 NULL
NULL 3 159 NULL 3 155 NULL
2432 -1 163 164 1 161 2
NULL 1 168 NULL 1 166 NULL
2579 -2 174 171 2 172 -2
NULL -1 179 NULL 1 176 NULL
2728 -3 182 183 3 184 3
2806 -1 188 185 1 187 -4
2878 1 191 190 1 193 -2
2949 3 199 196 3 195 -1
NULL NULL 201 203 NULL 202 -1
NULL -2 NULL 207 2 208 NULL
3175 -3 213 212 3 214 2
3260 3 216 217 3 215 -2
3331 -1 220 222 1 224 1
3399 3 229 226 3 225 -1
3473 1 234 233 1 231 3
NULL -4 243 NULL 4 244 NULL
3706 2 245 248 2 247 2
NULL NULL 239 238 NULL NULL 1

query TTIITIT
select a+b*2+c*3+d*4+e*5 as col1,
       b-c as col2,
       abs(a) as col3,
       d as col4,
       abs(b-c) as col5,
       c as col6,
       d-e as col7
from t1
order by col4,col3,col5,col2,col6,col7,col1
----
NULL NULL 104 101 NULL 102 NULL
1612 -1 107 108 1 106 -1
NULL -1 NULL 114 1 113 4
NULL NULL 115 116 NULL 119 -1
NULL 1 121 122 1 123 NULL
1902 4 127 128 4 125 2
1985 -4 131 133 4 134 1
2046 2 138 136 2 137 1
2131 2 142 140 2 141 -4
2432 -1 163 164 1 161 2
2579 -2 174 171 2 172 -2
2728 -3 182 183 3 184 3
2806 -1 188 185 1 187 -4
2878 1 191 190 1 193 -2
2949 3 199 196 3 195 -1
NULL NULL 201 203 NULL 202 -1
NULL -2 NULL 207 2 208 NULL
3175 -3 213 212 3 214 2
3260 3 216 217 3 215 -2
3331 -1 220 222 1 224 1
3399 3 229 226 3 225 -1
3473 1 234 233 1 231 3
NULL NULL 239 238 NULL NULL 1
3706 2 245 248 2 247 2
NULL -2 149 NULL 2 147 NULL
NULL 1 153 NULL 1 150 NULL
NULL 3 159 NULL 3 155 NULL
NULL 1 168 NULL 1 166 NULL
NULL -1 179 NULL 1 176 NULL
NULL -4 243 NULL 4 244 NULL

query IIIII
select a+b*2 as col1,
       a as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       e as col4,
       c-d as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
    or (a>b-2 and a<b+2)
    or d not between 110 and 150
order by col4,col5,col2,col3,col1
----
317 107 1050 109 -2
NULL NULL 1120 110 -1
391 131 1300 132 1
416 138 1390 135 1
428 142 1430 144 1
475 159 1580 157 NULL
483 163 1600 162 -3
502 168 1670 165 NULL
514 174 1700 173 1
544 182 364 180 1
560 188 376 189 2
579 191 382 192 3
595 199 398 197 -1
NULL 201 402 204 -1
635 213 426 210 2
652 216 432 219 -2
666 220 440 221 2
685 229 458 227 -1
698 234 468 230 -2
711 239 2360 237 NULL
743 245 490 246 -1
NULL 104 NULL NULL 1
369 121 1240 NULL 1
NULL NULL NULL NULL 1

query IIIII
select a+b*2 as col1,
       a as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       e as col4,
       c-d as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
    or (a>b-2 and a<b+2)
    or d not between 110 and 150
order by col4,col5,col2,col3,col1
----
317 107 1050 109 -2
NULL NULL 1120 110 -1
391 131 1300 132 1
416 138 1390 135 1
428 142 1430 144 1
475 159 1580 157 NULL
483 163 1600 162 -3
502 168 1670 165 NULL
514 174 1700 173 1
544 182 364 180 1
560 188 376 189 2
579 191 382 192 3
595 199 398 197 -1
NULL 201 402 204 -1
635 213 426 210 2
652 216 432 219 -2
666 220 440 221 2
685 229 458 227 -1
698 234 468 230 -2
711 239 2360 237 NULL
743 245 490 246 -1
NULL 104 NULL NULL 1
369 121 1240 NULL 1
NULL NULL NULL NULL 1

query IIIII
select a+b*2 as col1,
       a as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       e as col4,
       c-d as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (a>b-2 and a<b+2)
    or c between b-2 and d+2
    or d not between 110 and 150
order by col4,col5,col2,col3,col1
----
317 107 1050 109 -2
NULL NULL 1120 110 -1
391 131 1300 132 1
416 138 1390 135 1
428 142 1430 144 1
475 159 1580 157 NULL
483 163 1600 162 -3
502 168 1670 165 NULL
514 174 1700 173 1
544 182 364 180 1
560 188 376 189 2
579 191 382 192 3
595 199 398 197 -1
NULL 201 402 204 -1
635 213 426 210 2
652 216 432 219 -2
666 220 440 221 2
685 229 458 227 -1
698 234 468 230 -2
711 239 2360 237 NULL
743 245 490 246 -1
NULL 104 NULL NULL 1
369 121 1240 NULL 1
NULL NULL NULL NULL 1

query IIIII
select a+b*2 as col1,
       a as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       e as col4,
       c-d as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (a>b-2 and a<b+2)
    or c between b-2 and d+2
    or d not between 110 and 150
order by col5,col2,col4,col3,col1
----
483 163 1600 162 -3
317 107 1050 109 -2
652 216 432 219 -2
698 234 468 230 -2
595 199 398 197 -1
NULL 201 402 204 -1
685 229 458 227 -1
743 245 490 246 -1
NULL NULL 1120 110 -1
NULL 104 NULL NULL 1
369 121 1240 NULL 1
391 131 1300 132 1
416 138 1390 135 1
428 142 1430 144 1
514 174 1700 173 1
544 182 364 180 1
NULL NULL NULL NULL 1
560 188 376 189 2
635 213 426 210 2
666 220 440 221 2
579 191 382 192 3
475 159 1580 157 NULL
502 168 1670 165 NULL
711 239 2360 237 NULL

query IIIII
select a+b*2 as col1,
       a as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       e as col4,
       c-d as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
    or d not between 110 and 150
    or (a>b-2 and a<b+2)
order by col4,col5,col2,col3,col1
----
317 107 1050 109 -2
NULL NULL 1120 110 -1
391 131 1300 132 1
416 138 1390 135 1
428 142 1430 144 1
475 159 1580 157 NULL
483 163 1600 162 -3
502 168 1670 165 NULL
514 174 1700 173 1
544 182 364 180 1
560 188 376 189 2
579 191 382 192 3
595 199 398 197 -1
NULL 201 402 204 -1
635 213 426 210 2
652 216 432 219 -2
666 220 440 221 2
685 229 458 227 -1
698 234 468 230 -2
711 239 2360 237 NULL
743 245 490 246 -1
NULL 104 NULL NULL 1
369 121 1240 NULL 1
NULL NULL NULL NULL 1

query IIIII
select a+b*2 as col1,
       a as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       e as col4,
       c-d as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
    or d not between 110 and 150
    or (a>b-2 and a<b+2)
order by col1,col3,col5,col4,col2
----
317 107 1050 109 -2
369 121 1240 NULL 1
391 131 1300 132 1
416 138 1390 135 1
428 142 1430 144 1
475 159 1580 157 NULL
483 163 1600 162 -3
502 168 1670 165 NULL
514 174 1700 173 1
544 182 364 180 1
560 188 376 189 2
579 191 382 192 3
595 199 398 197 -1
635 213 426 210 2
652 216 432 219 -2
666 220 440 221 2
685 229 458 227 -1
698 234 468 230 -2
711 239 2360 237 NULL
743 245 490 246 -1
NULL 201 402 204 -1
NULL NULL 1120 110 -1
NULL 104 NULL NULL 1
NULL NULL NULL NULL 1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       (a+b+c+d+e)/5 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a as col4,
       c-d as col5,
       a-b as col6
from t1
where (a>b-2 and a<b+2)
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       (a+b+c+d+e)/5 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a as col4,
       c-d as col5,
       a-b as col6
from t1
where (a>b-2 and a<b+2)
order by col1,col5,col2,col3,col4,col6

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4
from t1
where d>e
    or b>c
    or c between b-2 and d+2
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4
from t1
where d>e
    or b>c
    or c between b-2 and d+2
order by col3,col2,col4,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4
from t1
where c between b-2 and d+2
    or b>c
    or d>e
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4
from t1
where c between b-2 and d+2
    or b>c
    or d>e
order by col1,col4,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4
from t1
where c between b-2 and d+2
    or d>e
    or b>c
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4
from t1
where c between b-2 and d+2
    or d>e
    or b>c
order by col3,col2,col4,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2+c*3+d*4 as col2,
       d-e as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       (a+b+c+d+e)/5 as col5,
       a+b*2 as col6,
       a-b as col7
from t1
where c between b-2 and d+2
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2+c*3+d*4 as col2,
       d-e as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       (a+b+c+d+e)/5 as col5,
       a+b*2 as col6,
       a-b as col7
from t1
where c between b-2 and d+2
order by col5,col6,col1,col3,col7,col4,col2

query TIII
select a+b*2+c*3+d*4 as col1,
       a+b*2+c*3 as col2,
       c as col3,
       case when c>avg_c then a*2 else b*10 end as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
order by col4,col2,col3,col1
----
NULL 1057 176 358
1828 1096 184 364
1861 1121 187 376
1964 1180 195 398
NULL NULL 202 402
2125 1277 214 426
2165 1297 215 432
2226 1338 224 440
2264 1360 225 458
2323 1391 231 468
2476 1484 247 490
1067 635 106 1050
NULL NULL 113 1120
1272 760 125 1290
1325 793 134 1300
1371 827 137 1390
1411 851 141 1430
NULL 940 155 1580
1622 966 161 1600
1714 1030 172 1700
NULL NULL NULL 2360

query IIII
select a+b*2+c*3+d*4 as col1,
       a+b*2+c*3 as col2,
       c as col3,
       case when c>avg_c then a*2 else b*10 end as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
order by col2,col4,col3,col1
----
1067 635 106 1050
1272 760 125 1290
1325 793 134 1300
1371 827 137 1390
1411 851 141 1430
NULL 940 155 1580
1622 966 161 1600
1714 1030 172 1700
NULL 1057 176 358
1828 1096 184 364
1861 1121 187 376
1964 1180 195 398
2125 1277 214 426
2165 1297 215 432
2226 1338 224 440
2264 1360 225 458
2323 1391 231 468
2476 1484 247 490
NULL NULL 202 402
NULL NULL 113 1120
NULL NULL NULL 2360

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       a+b*2 as col2,
       a+b*2+c*3 as col3,
       (a+b+c+d+e)/5 as col4,
       c as col5,
       d as col6,
       c-d as col7
from t1
where c between b-2 and d+2
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       a+b*2 as col2,
       a+b*2+c*3 as col3,
       (a+b+c+d+e)/5 as col4,
       c as col5,
       d as col6,
       c-d as col7
from t1
where c between b-2 and d+2
order by col1,col3,col2,col6,col5,col7,col4

query I
select a as col1
from t1
where (e>a and e<b)
order by col1
----
191
220
245

query I
select a as col1
from t1
where (e>a and e<b)
order by col1
----
191
220
245

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a+b*2+c*3+d*4 as col3,
       b-c as col4
from t1
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a+b*2+c*3+d*4 as col3,
       b-c as col4
from t1
order by col3,col1,col4,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       a+b*2 as col2
from t1
where (a>b-2 and a<b+2)
   and b>c
   and a>b
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       a+b*2 as col2
from t1
where (a>b-2 and a<b+2)
   and b>c
   and a>b
order by col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       a+b*2 as col2
from t1
where a>b
   and b>c
   and (a>b-2 and a<b+2)
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       a+b*2 as col2
from t1
where a>b
   and b>c
   and (a>b-2 and a<b+2)
order by col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       a+b*2 as col2
from t1
where b>c
   and a>b
   and (a>b-2 and a<b+2)
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       a+b*2 as col2
from t1
where b>c
   and a>b
   and (a>b-2 and a<b+2)
order by col2,col1

query II
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       a as col2
from t1
order by col2,col1
----
444 104
333 107
444 115
222 121
222 127
333 131
222 138
222 142
444 149
333 153
333 159
444 163
333 168
444 174
444 179
333 182
333 188
222 191
333 199
444 201
333 213
222 216
222 220
333 229
333 234
444 239
444 243
111 245
444 NULL
444 NULL

query II
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       a as col2
from t1
order by col2,col1
----
444 104
333 107
444 115
222 121
222 127
333 131
222 138
222 142
444 149
333 153
333 159
444 163
333 168
444 174
444 179
333 182
333 188
222 191
333 199
444 201
333 213
222 216
222 220
333 229
333 234
444 239
444 243
111 245
444 NULL
444 NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b as col3,
       d-e as col4
from t1
where (c<=d-2 or c>=d+2)
    or d>e
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b as col3,
       d-e as col4
from t1
where (c<=d-2 or c>=d+2)
    or d>e
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b as col3,
       d-e as col4
from t1
where d>e
    or (c<=d-2 or c>=d+2)
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b as col3,
       d-e as col4
from t1
where d>e
    or (c<=d-2 or c>=d+2)
order by col4,col1,col3,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       (a+b+c+d+e)/5 as col5
from t1
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       (a+b+c+d+e)/5 as col5
from t1
order by col3,col5,col1,col4,col2

query IIIII
select e as col1,
       d-e as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       b as col4,
       a as col5
from t1
order by col4,col5,col2,col3,col1
----
109 -1 333 105 107
110 4 444 112 NULL
NULL NULL 222 124 121
126 2 222 129 127
132 1 333 130 131
135 1 222 139 138
144 -4 222 143 142
146 NULL 444 145 149
NULL NULL 333 151 153
157 NULL 333 158 159
162 2 444 160 163
165 NULL 333 167 168
173 -2 444 170 174
177 NULL 444 175 179
180 3 333 181 182
189 -4 333 186 188
192 -2 222 194 191
197 -1 333 198 199
NULL NULL 444 206 NULL
210 2 333 211 213
219 -2 222 218 216
221 1 222 223 220
227 -1 333 228 229
230 3 333 232 234
237 1 444 236 239
NULL NULL 444 240 243
246 2 111 249 245
NULL NULL 444 NULL 104
117 -1 444 NULL 115
204 -1 444 NULL 201

query IIIII
select e as col1,
       d-e as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       b as col4,
       a as col5
from t1
order by col4,col2,col3,col5,col1
----
109 -1 333 105 107
110 4 444 112 NULL
NULL NULL 222 124 121
126 2 222 129 127
132 1 333 130 131
135 1 222 139 138
144 -4 222 143 142
146 NULL 444 145 149
NULL NULL 333 151 153
157 NULL 333 158 159
162 2 444 160 163
165 NULL 333 167 168
173 -2 444 170 174
177 NULL 444 175 179
180 3 333 181 182
189 -4 333 186 188
192 -2 222 194 191
197 -1 333 198 199
NULL NULL 444 206 NULL
210 2 333 211 213
219 -2 222 218 216
221 1 222 223 220
227 -1 333 228 229
230 3 333 232 234
237 1 444 236 239
NULL NULL 444 240 243
246 2 111 249 245
117 -1 444 NULL 115
204 -1 444 NULL 201
NULL NULL 444 NULL 104

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where a>b
    or (a>b-2 and a<b+2)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where a>b
    or (a>b-2 and a<b+2)
order by col1,col3,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where (a>b-2 and a<b+2)
    or a>b
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where (a>b-2 and a<b+2)
    or a>b
order by col1,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       b as col3,
       d-e as col4,
       abs(b-c) as col5,
       d as col6
from t1
where d not between 110 and 150
    or c between b-2 and d+2
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       b as col3,
       d-e as col4,
       abs(b-c) as col5,
       d as col6
from t1
where d not between 110 and 150
    or c between b-2 and d+2
order by col3,col4,col6,col5,col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       b as col3,
       d-e as col4,
       abs(b-c) as col5,
       d as col6
from t1
where c between b-2 and d+2
    or d not between 110 and 150
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       b as col3,
       d-e as col4,
       abs(b-c) as col5,
       d as col6
from t1
where c between b-2 and d+2
    or d not between 110 and 150
order by col6,col4,col5,col2,col3,col1

query IFIIIII
select d-e as col1,
       (a+b+c+d+e)/5 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       a-b as col5,
       a+b*2+c*3+d*4 as col6,
       abs(a) as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col6,col7,col4,col5,col2,col3,col1
----
-1 107.0 333 1050 2 1067 107
NULL NULL 333 1240 -3 1226 121
2 127.0 333 1290 -2 1272 127
1 132.0 444 1300 1 1325 131
1 137.0 111 1390 -1 1371 138
-4 142.0 111 1430 -1 1411 142
2 162.0 333 1600 3 1622 163
-2 172.0 555 1700 4 1714 174
3 182.0 333 364 1 1828 182
-4 187.0 444 376 2 1861 188
-2 192.0 444 382 -3 1918 191
-1 197.0 555 398 1 1964 199
2 212.0 222 426 2 2125 213
-2 217.0 333 432 -2 2165 216
1 222.0 444 440 -3 2226 220
-1 227.0 555 458 1 2264 229
3 232.0 555 468 2 2323 234
2 247.0 444 490 -4 2476 245
NULL NULL 555 NULL NULL NULL 104
-1 NULL 333 NULL NULL NULL 115
NULL NULL 555 1450 4 NULL 149
NULL NULL 555 1510 2 NULL 153
NULL NULL 555 1580 1 NULL 159
NULL NULL 555 1670 1 NULL 168
NULL NULL 555 358 4 NULL 179
-1 NULL 222 402 NULL NULL 201
1 NULL 555 2360 3 NULL 239
NULL NULL 222 486 3 NULL 243
4 NULL 555 1120 NULL NULL NULL
NULL NULL 555 NULL NULL NULL NULL

query TTITTTI
select d-e as col1,
       (a+b+c+d+e)/5 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       a-b as col5,
       a+b*2+c*3+d*4 as col6,
       abs(a) as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col7,col6,col2,col1,col3,col4,col5
----
NULL NULL 555 NULL NULL NULL 104
-1 107.0 333 1050 2 1067 107
-1 NULL 333 NULL NULL NULL 115
NULL NULL 333 1240 -3 1226 121
2 127.0 333 1290 -2 1272 127
1 132.0 444 1300 1 1325 131
1 137.0 111 1390 -1 1371 138
-4 142.0 111 1430 -1 1411 142
NULL NULL 555 1450 4 NULL 149
NULL NULL 555 1510 2 NULL 153
NULL NULL 555 1580 1 NULL 159
2 162.0 333 1600 3 1622 163
NULL NULL 555 1670 1 NULL 168
-2 172.0 555 1700 4 1714 174
NULL NULL 555 358 4 NULL 179
3 182.0 333 364 1 1828 182
-4 187.0 444 376 2 1861 188
-2 192.0 444 382 -3 1918 191
-1 197.0 555 398 1 1964 199
-1 NULL 222 402 NULL NULL 201
2 212.0 222 426 2 2125 213
-2 217.0 333 432 -2 2165 216
1 222.0 444 440 -3 2226 220
-1 227.0 555 458 1 2264 229
3 232.0 555 468 2 2323 234
1 NULL 555 2360 3 NULL 239
NULL NULL 222 486 3 NULL 243
2 247.0 444 490 -4 2476 245
4 NULL 555 1120 NULL NULL NULL
NULL NULL 555 NULL NULL NULL NULL

query ITTII
select c-d as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       (a+b+c+d+e)/5 as col3,
       abs(a) as col4,
       d as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col4,col5,col2,col3,col1
----
1 NULL NULL 104 101
-2 1050 107.0 107 108
3 NULL NULL 115 116
1 1240 NULL 121 122
-3 1290 127.0 127 128
1 1300 132.0 131 133
1 1390 137.0 138 136
1 1430 142.0 142 140
NULL 1450 NULL 149 NULL
NULL 1510 NULL 153 NULL
NULL 1580 NULL 159 NULL
-3 1600 162.0 163 164
NULL 1670 NULL 168 NULL
1 1700 172.0 174 171
NULL 358 NULL 179 NULL
1 364 182.0 182 183
2 376 187.0 188 185
3 382 192.0 191 190
-1 398 197.0 199 196
-1 402 NULL 201 203
2 426 212.0 213 212
-2 432 217.0 216 217
2 440 222.0 220 222
-1 458 227.0 229 226
-2 468 232.0 234 233
NULL 2360 NULL 239 238
NULL 486 NULL 243 NULL
-1 490 247.0 245 248
-1 1120 NULL NULL 114
1 NULL NULL NULL 207

query IIFII
select c-d as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       (a+b+c+d+e)/5 as col3,
       abs(a) as col4,
       d as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col1,col2,col4,col5,col3
----
-3 1290 127.0 127 128
-3 1600 162.0 163 164
-2 432 217.0 216 217
-2 468 232.0 234 233
-2 1050 107.0 107 108
-1 398 197.0 199 196
-1 402 NULL 201 203
-1 458 227.0 229 226
-1 490 247.0 245 248
-1 1120 NULL NULL 114
1 364 182.0 182 183
1 1240 NULL 121 122
1 1300 132.0 131 133
1 1390 137.0 138 136
1 1430 142.0 142 140
1 1700 172.0 174 171
1 NULL NULL 104 101
1 NULL NULL NULL 207
2 376 187.0 188 185
2 426 212.0 213 212
2 440 222.0 220 222
3 382 192.0 191 190
3 NULL NULL 115 116
NULL 358 NULL 179 NULL
NULL 486 NULL 243 NULL
NULL 1450 NULL 149 NULL
NULL 1510 NULL 153 NULL
NULL 1580 NULL 159 NULL
NULL 1670 NULL 168 NULL
NULL 2360 NULL 239 238

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2
from t1
where e+d between a+b-10 and c+130
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2
from t1
where e+d between a+b-10 and c+130
order by col1,col2

query IIII
select a as col1,
       d-e as col2,
       c as col3,
       case when c>avg_c then a*2 else b*10 end as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (c<=d-2 or c>=d+2)
    or b>c
    or c between b-2 and d+2
order by col4,col2,col3,col1
----
182 3 184 364
188 -4 187 376
191 -2 193 382
199 -1 195 398
213 2 214 426
216 -2 215 432
220 1 224 440
229 -1 225 458
234 3 231 468
245 2 247 490
107 -1 106 1050
NULL 4 113 1120
121 NULL 123 1240
127 2 125 1290
131 1 134 1300
138 1 137 1390
142 -4 141 1430
153 NULL 150 1510
159 NULL 155 1580
163 2 161 1600
168 NULL 166 1670
174 -2 172 1700
115 -1 119 NULL
NULL NULL 208 NULL

query IIII
select a as col1,
       d-e as col2,
       c as col3,
       case when c>avg_c then a*2 else b*10 end as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (c<=d-2 or c>=d+2)
    or b>c
    or c between b-2 and d+2
order by col1,col2,col4,col3
----
107 -1 106 1050
115 -1 119 NULL
121 NULL 123 1240
127 2 125 1290
131 1 134 1300
138 1 137 1390
142 -4 141 1430
153 NULL 150 1510
159 NULL 155 1580
163 2 161 1600
168 NULL 166 1670
174 -2 172 1700
182 3 184 364
188 -4 187 376
191 -2 193 382
199 -1 195 398
213 2 214 426
216 -2 215 432
220 1 224 440
229 -1 225 458
234 3 231 468
245 2 247 490
NULL 4 113 1120
NULL NULL 208 NULL

query IIII
select a as col1,
       d-e as col2,
       c as col3,
       case when c>avg_c then a*2 else b*10 end as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
    or b>c
    or (c<=d-2 or c>=d+2)
order by col4,col2,col3,col1
----
182 3 184 364
188 -4 187 376
191 -2 193 382
199 -1 195 398
213 2 214 426
216 -2 215 432
220 1 224 440
229 -1 225 458
234 3 231 468
245 2 247 490
107 -1 106 1050
NULL 4 113 1120
121 NULL 123 1240
127 2 125 1290
131 1 134 1300
138 1 137 1390
142 -4 141 1430
153 NULL 150 1510
159 NULL 155 1580
163 2 161 1600
168 NULL 166 1670
174 -2 172 1700
115 -1 119 NULL
NULL NULL 208 NULL

query IIII
select a as col1,
       d-e as col2,
       c as col3,
       case when c>avg_c then a*2 else b*10 end as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
    or b>c
    or (c<=d-2 or c>=d+2)
order by col2,col4,col3,col1
----
188 -4 187 376
142 -4 141 1430
191 -2 193 382
216 -2 215 432
174 -2 172 1700
199 -1 195 398
229 -1 225 458
107 -1 106 1050
115 -1 119 NULL
220 1 224 440
131 1 134 1300
138 1 137 1390
213 2 214 426
245 2 247 490
127 2 125 1290
163 2 161 1600
182 3 184 364
234 3 231 468
NULL 4 113 1120
121 NULL 123 1240
153 NULL 150 1510
159 NULL 155 1580
168 NULL 166 1670
NULL NULL 208 NULL

query TIIIII
select e as col1,
       a+b*2 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a-b as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       abs(b-c) as col6
from t1
order by col6,col4,col5,col2,col3,col1
----
NULL 369 222 -3 333 1
192 579 222 -3 444 1
221 666 222 -3 444 1
165 502 333 1 555 1
109 317 333 2 333 1
189 560 333 2 444 1
NULL 455 333 2 555 1
230 698 333 2 555 1
162 483 444 3 333 1
177 529 444 4 555 1
110 NULL 444 NULL 555 1
246 743 111 -4 444 2
135 416 222 -1 111 2
144 428 222 -1 111 2
146 439 444 4 555 2
173 514 444 4 555 2
NULL NULL 444 NULL 555 2
219 652 222 -2 333 3
180 544 333 1 333 3
157 475 333 1 555 3
197 595 333 1 555 3
227 685 333 1 555 3
210 635 333 2 222 3
126 385 222 -2 333 4
132 391 333 1 444 4
NULL 723 444 3 222 4
237 711 444 3 555 NULL
204 NULL 444 NULL 222 NULL
117 NULL 444 NULL 333 NULL
NULL NULL 444 NULL 555 NULL

query IIIIII
select e as col1,
       a+b*2 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a-b as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       abs(b-c) as col6
from t1
order by col1,col3,col5,col6,col4,col2
----
109 317 333 2 333 1
110 NULL 444 NULL 555 1
117 NULL 444 NULL 333 NULL
126 385 222 -2 333 4
132 391 333 1 444 4
135 416 222 -1 111 2
144 428 222 -1 111 2
146 439 444 4 555 2
157 475 333 1 555 3
162 483 444 3 333 1
165 502 333 1 555 1
173 514 444 4 555 2
177 529 444 4 555 1
180 544 333 1 333 3
189 560 333 2 444 1
192 579 222 -3 444 1
197 595 333 1 555 3
204 NULL 444 NULL 222 NULL
210 635 333 2 222 3
219 652 222 -2 333 3
221 666 222 -3 444 1
227 685 333 1 555 3
230 698 333 2 555 1
237 711 444 3 555 NULL
246 743 111 -4 444 2
NULL 369 222 -3 333 1
NULL 455 333 2 555 1
NULL 723 444 3 222 4
NULL NULL 444 NULL 555 2
NULL NULL 444 NULL 555 NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1
from t1
where (e>c or e<d)
   and d not between 110 and 150
   and c between b-2 and d+2
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1
from t1
where (e>c or e<d)
   and d not between 110 and 150
   and c between b-2 and d+2
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1
from t1
where c between b-2 and d+2
   and d not between 110 and 150
   and (e>c or e<d)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1
from t1
where c between b-2 and d+2
   and d not between 110 and 150
   and (e>c or e<d)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1
from t1
where d not between 110 and 150
   and (e>c or e<d)
   and c between b-2 and d+2
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1
from t1
where d not between 110 and 150
   and (e>c or e<d)
   and c between b-2 and d+2
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       a+b*2 as col2,
       b-c as col3
from t1
where (a>b-2 and a<b+2)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       a+b*2 as col2,
       b-c as col3
from t1
where (a>b-2 and a<b+2)
order by col2,col1,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       d as col2,
       a+b*2 as col3,
       a+b*2+c*3 as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       b as col6,
       e as col7
from t1
where a>b
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       d as col2,
       a+b*2 as col3,
       a+b*2+c*3 as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       b as col6,
       e as col7
from t1
where a>b
order by col1,col5,col7,col6,col4,col3,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       d-e as col2,
       e as col3
from t1
where d not between 110 and 150
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       d-e as col2,
       e as col3
from t1
where d not between 110 and 150
order by col2,col1,col3

query I
select e as col1
from t1
where (a>b-2 and a<b+2)
    or b>c
order by col1
----
126
132
135
144
157
165
180
192
197
219
227
230
246
NULL
NULL

query I
select e as col1
from t1
where (a>b-2 and a<b+2)
    or b>c
order by col1
----
126
132
135
144
157
165
180
192
197
219
227
230
246
NULL
NULL

query I
select e as col1
from t1
where b>c
    or (a>b-2 and a<b+2)
order by col1
----
126
132
135
144
157
165
180
192
197
219
227
230
246
NULL
NULL

query I
select e as col1
from t1
where b>c
    or (a>b-2 and a<b+2)
order by col1
----
126
132
135
144
157
165
180
192
197
219
227
230
246
NULL
NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a+b*2+c*3+d*4 as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a-b as col5
from t1
where d>e
   and e+d between a+b-10 and c+130
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a+b*2+c*3+d*4 as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a-b as col5
from t1
where d>e
   and e+d between a+b-10 and c+130
order by col2,col4,col5,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       a+b*2 as col2,
       abs(a) as col3,
       abs(b-c) as col4,
       a-b as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where d>e
    or (e>a and e<b)
    or e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       a+b*2 as col2,
       abs(a) as col3,
       abs(b-c) as col4,
       a-b as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where d>e
    or (e>a and e<b)
    or e+d between a+b-10 and c+130
order by col2,col5,col3,col1,col4,col6

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       a+b*2 as col2,
       abs(a) as col3,
       abs(b-c) as col4,
       a-b as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where (e>a and e<b)
    or e+d between a+b-10 and c+130
    or d>e
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       a+b*2 as col2,
       abs(a) as col3,
       abs(b-c) as col4,
       a-b as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where (e>a and e<b)
    or e+d between a+b-10 and c+130
    or d>e
order by col5,col1,col6,col2,col4,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       a+b*2 as col2,
       abs(a) as col3,
       abs(b-c) as col4,
       a-b as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where e+d between a+b-10 and c+130
    or d>e
    or (e>a and e<b)
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       a+b*2 as col2,
       abs(a) as col3,
       abs(b-c) as col4,
       a-b as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where e+d between a+b-10 and c+130
    or d>e
    or (e>a and e<b)
order by col2,col3,col4,col1,col5,col6

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       a+b*2 as col2,
       abs(a) as col3,
       abs(b-c) as col4,
       a-b as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where d>e
    or e+d between a+b-10 and c+130
    or (e>a and e<b)
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       a+b*2 as col2,
       abs(a) as col3,
       abs(b-c) as col4,
       a-b as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where d>e
    or e+d between a+b-10 and c+130
    or (e>a and e<b)
order by col3,col4,col1,col5,col6,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a+b*2+c*3+d*4 as col3,
       abs(b-c) as col4,
       a+b*2+c*3+d*4+e*5 as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a+b*2+c*3+d*4 as col3,
       abs(b-c) as col4,
       a+b*2+c*3+d*4+e*5 as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
order by col6,col4,col2,col5,col3,col1

query IIFIIII
select a+b*2+c*3+d*4 as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       (a+b+c+d+e)/5 as col3,
       a+b*2+c*3 as col4,
       abs(b-c) as col5,
       d as col6,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a>b
    or (c<=d-2 or c>=d+2)
order by col6,col7,col4,col5,col2,col3,col1
----
1067 1050 107.0 635 1 108 333
NULL NULL NULL NULL NULL 116 333
1272 1290 127.0 760 4 128 333
1325 1300 132.0 793 4 133 444
1622 1600 162.0 966 1 164 333
1714 1700 172.0 1030 2 171 555
1828 364 182.0 1096 3 183 333
1861 376 187.0 1121 1 185 444
1918 382 192.0 1158 1 190 444
1964 398 197.0 1180 3 196 555
2125 426 212.0 1277 3 212 222
2165 432 217.0 1297 3 217 333
2226 440 222.0 1338 1 222 444
2264 458 227.0 1360 3 226 555
2323 468 232.0 1391 1 233 555
NULL 2360 NULL NULL NULL 238 555
NULL 486 NULL 1455 4 NULL 222
NULL 1450 NULL 880 2 NULL 555
NULL 1510 NULL 905 1 NULL 555
NULL 1580 NULL 940 3 NULL 555
NULL 1670 NULL 1000 1 NULL 555
NULL 358 NULL 1057 1 NULL 555

query IIFIIII
select a+b*2+c*3+d*4 as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       (a+b+c+d+e)/5 as col3,
       a+b*2+c*3 as col4,
       abs(b-c) as col5,
       d as col6,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a>b
    or (c<=d-2 or c>=d+2)
order by col4,col6,col5,col3,col7,col2,col1
----
1067 1050 107.0 635 1 108 333
1272 1290 127.0 760 4 128 333
1325 1300 132.0 793 4 133 444
NULL 1450 NULL 880 2 NULL 555
NULL 1510 NULL 905 1 NULL 555
NULL 1580 NULL 940 3 NULL 555
1622 1600 162.0 966 1 164 333
NULL 1670 NULL 1000 1 NULL 555
1714 1700 172.0 1030 2 171 555
NULL 358 NULL 1057 1 NULL 555
1828 364 182.0 1096 3 183 333
1861 376 187.0 1121 1 185 444
1918 382 192.0 1158 1 190 444
1964 398 197.0 1180 3 196 555
2125 426 212.0 1277 3 212 222
2165 432 217.0 1297 3 217 333
2226 440 222.0 1338 1 222 444
2264 458 227.0 1360 3 226 555
2323 468 232.0 1391 1 233 555
NULL 486 NULL 1455 4 NULL 222
NULL NULL NULL NULL NULL 116 333
NULL 2360 NULL NULL NULL 238 555

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       d-e as col3,
       a+b*2+c*3 as col4,
       a+b*2 as col5,
       e as col6
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (e>a and e<b)
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       d-e as col3,
       a+b*2+c*3 as col4,
       a+b*2 as col5,
       e as col6
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (e>a and e<b)
order by col1,col5,col4,col6,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       d-e as col3,
       a+b*2+c*3 as col4,
       a+b*2 as col5,
       e as col6
from t1
where (e>a and e<b)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       d-e as col3,
       a+b*2+c*3 as col4,
       a+b*2 as col5,
       e as col6
from t1
where (e>a and e<b)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col6,col1,col2,col4,col5,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       e as col2,
       d as col3,
       abs(a) as col4,
       abs(b-c) as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       e as col2,
       d as col3,
       abs(a) as col4,
       abs(b-c) as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col7
from t1
order by col1,col6,col5,col2,col3,col7,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       (a+b+c+d+e)/5 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       abs(b-c) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       (a+b+c+d+e)/5 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       abs(b-c) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col5,col1,col4,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       b as col2,
       a-b as col3,
       c-d as col4,
       d-e as col5,
       e as col6
from t1
where b>c
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       b as col2,
       a-b as col3,
       c-d as col4,
       d-e as col5,
       e as col6
from t1
where b>c
order by col3,col1,col4,col2,col6,col5

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       d-e as col2
from t1
where (a>b-2 and a<b+2)
   and b>c
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       d-e as col2
from t1
where (a>b-2 and a<b+2)
   and b>c
order by col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       d-e as col2
from t1
where b>c
   and (a>b-2 and a<b+2)
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       d-e as col2
from t1
where b>c
   and (a>b-2 and a<b+2)
order by col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       b-c as col2
from t1
where (e>a and e<b)
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       b-c as col2
from t1
where (e>a and e<b)
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       abs(a) as col2,
       abs(b-c) as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       d as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       abs(a) as col2,
       abs(b-c) as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       d as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
order by col2,col1,col6,col7,col4,col5,col3

query II
select a+b*2+c*3+d*4 as col1,
       b-c as col2
from t1
order by col2,col1
----
1325 -4
NULL -4
1828 -3
2125 -3
1714 -2
NULL -2
NULL -2
1067 -1
1622 -1
1861 -1
2226 -1
NULL -1
NULL -1
1226 1
1918 1
2323 1
NULL 1
NULL 1
1371 2
1411 2
2476 2
1964 3
2165 3
2264 3
NULL 3
1272 4
NULL NULL
NULL NULL
NULL NULL
NULL NULL

query II
select a+b*2+c*3+d*4 as col1,
       b-c as col2
from t1
order by col2,col1
----
1325 -4
NULL -4
1828 -3
2125 -3
1714 -2
NULL -2
NULL -2
1067 -1
1622 -1
1861 -1
2226 -1
NULL -1
NULL -1
1226 1
1918 1
2323 1
NULL 1
NULL 1
1371 2
1411 2
2476 2
1964 3
2165 3
2264 3
NULL 3
1272 4
NULL NULL
NULL NULL
NULL NULL
NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       (a+b+c+d+e)/5 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where a>b
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       (a+b+c+d+e)/5 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where a>b
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1,col3

query IIIIIII
select a as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       d-e as col3,
       b-c as col4,
       abs(a) as col5,
       a+b*2 as col6,
       b as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1
----
107 1612 -1 -1 107 317 105
121 NULL NULL 1 121 369 124
127 1902 2 4 127 385 129
131 1985 1 -4 131 391 130
138 2046 1 2 138 416 139
142 2131 -4 2 142 428 143
149 NULL NULL -2 149 439 145
153 NULL NULL 1 153 455 151
159 NULL NULL 3 159 475 158
163 2432 2 -1 163 483 160
168 NULL NULL 1 168 502 167
174 2579 -2 -2 174 514 170
179 NULL NULL -1 179 529 175
182 2728 3 -3 182 544 181
188 2806 -4 -1 188 560 186
191 2878 -2 1 191 579 194
199 2949 -1 3 199 595 198
213 3175 2 -3 213 635 211
216 3260 -2 3 216 652 218
220 3331 1 -1 220 666 223
229 3399 -1 3 229 685 228
234 3473 3 1 234 698 232
239 NULL 1 NULL 239 711 236
243 NULL NULL -4 243 723 240
245 3706 2 2 245 743 249
NULL NULL 4 -1 NULL NULL 112
NULL NULL NULL -2 NULL NULL 206
104 NULL NULL NULL 104 NULL NULL
115 NULL -1 NULL 115 NULL NULL
201 NULL -1 NULL 201 NULL NULL

query IIIIIII
select a as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       d-e as col3,
       b-c as col4,
       abs(a) as col5,
       a+b*2 as col6,
       b as col7
from t1
order by col4,col2,col3,col6,col1,col5,col7
----
131 1985 1 -4 131 391 130
243 NULL NULL -4 243 723 240
182 2728 3 -3 182 544 181
213 3175 2 -3 213 635 211
174 2579 -2 -2 174 514 170
149 NULL NULL -2 149 439 145
NULL NULL NULL -2 NULL NULL 206
107 1612 -1 -1 107 317 105
163 2432 2 -1 163 483 160
188 2806 -4 -1 188 560 186
220 3331 1 -1 220 666 223
NULL NULL 4 -1 NULL NULL 112
179 NULL NULL -1 179 529 175
191 2878 -2 1 191 579 194
234 3473 3 1 234 698 232
121 NULL NULL 1 121 369 124
153 NULL NULL 1 153 455 151
168 NULL NULL 1 168 502 167
138 2046 1 2 138 416 139
142 2131 -4 2 142 428 143
245 3706 2 2 245 743 249
199 2949 -1 3 199 595 198
216 3260 -2 3 216 652 218
229 3399 -1 3 229 685 228
159 NULL NULL 3 159 475 158
127 1902 2 4 127 385 129
115 NULL -1 NULL 115 NULL NULL
201 NULL -1 NULL 201 NULL NULL
239 NULL 1 NULL 239 711 236
104 NULL NULL NULL 104 NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a+b*2+c*3 as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a+b*2+c*3 as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
order by col2,col1,col3,col4,col5

