statement ok
drop table if exists t1 all

statement ok
create table t1(a integer null, b integer null, c integer null, d integer null, e integer null)

statement ok
insert into t1(e,c,b,d,a) values(null,102,null,101,104)

statement ok
insert into t1(a,c,d,e,b) values(107,106,108,109,105)

statement ok
insert into t1(e,d,b,a,c) values(110,114,112,null,113)

statement ok
insert into t1(d,c,e,a,b) values(116,119,117,115,null)

statement ok
insert into t1(c,d,b,e,a) values(123,122,124,null,121)

statement ok
insert into t1(a,d,b,e,c) values(127,128,129,126,125)

statement ok
insert into t1(e,c,a,d,b) values(132,134,131,133,130)

statement ok
insert into t1(a,d,b,e,c) values(138,136,139,135,137)

statement ok
insert into t1(e,c,d,a,b) values(144,141,140,142,143)

statement ok
insert into t1(b,a,e,d,c) values(145,149,146,null,147)

statement ok
insert into t1(b,c,a,d,e) values(151,150,153,null,null)

statement ok
insert into t1(c,e,a,d,b) values(155,157,159,null,158)

statement ok
insert into t1(c,b,a,d,e) values(161,160,163,164,162)

statement ok
insert into t1(b,d,a,e,c) values(167,null,168,165,166)

statement ok
insert into t1(d,b,c,e,a) values(171,170,172,173,174)

statement ok
insert into t1(e,c,a,d,b) values(177,176,179,null,175)

statement ok
insert into t1(b,e,a,d,c) values(181,180,182,183,184)

statement ok
insert into t1(c,a,b,e,d) values(187,188,186,189,185)

statement ok
insert into t1(d,b,c,e,a) values(190,194,193,192,191)

statement ok
insert into t1(a,e,b,d,c) values(199,197,198,196,195)

statement ok
insert into t1(b,c,d,a,e) values(null,202,203,201,204)

statement ok
insert into t1(c,e,a,b,d) values(208,null,null,206,207)

statement ok
insert into t1(c,e,a,d,b) values(214,210,213,212,211)

statement ok
insert into t1(b,c,a,d,e) values(218,215,216,217,219)

statement ok
insert into t1(b,e,d,a,c) values(223,221,222,220,224)

statement ok
insert into t1(d,e,b,a,c) values(226,227,228,229,225)

statement ok
insert into t1(a,c,b,e,d) values(234,231,232,230,233)

statement ok
insert into t1(e,b,a,c,d) values(237,236,239,null,238)

statement ok
insert into t1(e,c,b,a,d) values(null,244,240,243,null)

statement ok
insert into t1(e,d,c,b,a) values(246,248,247,249,245)

query I
select case when c>avg_c then a*2 else b*10 end as col1
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col1
----
358
364
376
382
398
402
426
432
440
458
468
486
490
1050
1120
1240
1290
1300
1390
1430
1450
1510
1580
1600
1670
1700
2360
NULL
NULL
NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select e as col1,
       abs(a) as col2,
       b as col3,
       abs(b-c) as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       a+b*2 as col6,
       a+b*2+c*3+d*4 as col7
from t1
where a>b
order by col2,col5,col3,col4,col7,col6,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       b as col2,
       a+b*2+c*3+d*4 as col3
from t1
where coalesce(a,b,c,d,e)<>0
   and (a>b-2 and a<b+2)
order by col3,col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       d as col4
from t1
where a is null

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       d-e as col2
from t1
where e+d between a+b-10 and c+130
or (a>b-2 and a<b+2)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       b as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       a+b*2+c*3+d*4+e*5 as col6
from t1
where d not between 110 and 150
or b is not null

query I
select abs(b-c) as col1
from t1
order by col1
----
1
1
1
1
1
1
1
1
1
1
1
2
2
2
2
2
2
3
3
3
3
3
3
4
4
4
NULL
NULL
NULL
NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2 as col1
from t1
where (a>b-2 and a<b+2)
   and b is not null
   and a>b
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       d-e as col3,
       c-d as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       a+b*2+c*3+d*4+e*5 as col6,
       abs(a) as col7
from t1
where (c<=d-2 or c>=d+2)
   and coalesce(a,b,c,d,e)<>0
and c>d

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       abs(b-c) as col3,
       c-d as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       a+b*2 as col6,
       b-c as col7
from t1
where b>c
and (e>c or e<d)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select e as col1,
       b as col2,
       a as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       a-b as col6,
       (a+b+c+d+e)/5 as col7
from t1
where b is not null
and coalesce(a,b,c,d,e)<>0

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2+c*3 as col2,
       a-b as col3,
       d-e as col4
from t1
where d not between 110 and 150
   and c>d
and c between b-2 and d+2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       abs(a) as col2,
       d as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where e+d between a+b-10 and c+130
   and (e>c or e<d)
order by col1,col2,col3,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1

query IIF
select d-e as col1,
       c-d as col2,
       (a+b+c+d+e)/5 as col3
from t1
where coalesce(a,b,c,d,e)<>0
    or b>c
    or b is not null
order by col2,col1,col3
----
2 -3 127.0
2 -3 162.0
-2 -2 217.0
-1 -2 107.0
3 -2 232.0
-1 -1 197.0
-1 -1 227.0
-1 -1 NULL
2 -1 247.0
4 -1 NULL
-4 1 142.0
-2 1 172.0
1 1 132.0
1 1 137.0
3 1 182.0
NULL 1 NULL
NULL 1 NULL
NULL 1 NULL
-4 2 187.0
1 2 222.0
2 2 212.0
-2 3 192.0
-1 3 NULL
1 NULL NULL
NULL NULL NULL
NULL NULL NULL
NULL NULL NULL
NULL NULL NULL
NULL NULL NULL
NULL NULL NULL

query IIIIIII
select case when c>avg_c then a*2 else b*10 end as col1,
       b as col2,
       a+b*2+c*3+d*4 as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       d-e as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6,
       a-b as col7
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col5,col6,col3,col1,col4,col2,col7
----
1430 143 1411 222 -4 111 -1
376 186 1861 333 -4 444 2
432 218 2165 222 -2 333 -2
382 194 1918 222 -2 444 -3
1700 170 1714 444 -2 555 4
402 NULL NULL 444 -1 222 NULL
1050 105 1067 333 -1 333 2
NULL NULL NULL 444 -1 333 NULL
398 198 1964 333 -1 555 1
458 228 2264 333 -1 555 1
1390 139 1371 222 1 111 -1
1300 130 1325 333 1 444 1
440 223 2226 222 1 444 -3
2360 236 NULL 444 1 555 3
426 211 2125 333 2 222 2
1290 129 1272 222 2 333 -2
1600 160 1622 444 2 333 3
490 249 2476 111 2 444 -4
364 181 1828 333 3 333 1
468 232 2323 333 3 555 2
1120 112 NULL 444 4 555 NULL
486 240 NULL 444 NULL 222 3
1240 124 1226 222 NULL 333 -3
358 175 NULL 444 NULL 555 4
1450 145 NULL 444 NULL 555 4
1510 151 NULL 333 NULL 555 2
1580 158 NULL 333 NULL 555 1
1670 167 NULL 333 NULL 555 1
NULL 206 NULL 444 NULL 555 NULL
NULL NULL NULL 444 NULL 555 NULL

query III
select a+b*2+c*3+d*4+e*5 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       e as col3
from t1
where coalesce(a,b,c,d,e)<>0
    or b>c
    or a>b
order by col1,col2,col3
----
1612 333 109
1902 333 126
1985 444 132
2046 111 135
2131 111 144
2432 333 162
2579 555 173
2728 333 180
2806 444 189
2878 444 192
2949 555 197
3175 222 210
3260 333 219
3331 444 221
3399 555 227
3473 555 230
3706 444 246
NULL 222 204
NULL 222 NULL
NULL 333 117
NULL 333 NULL
NULL 555 110
NULL 555 146
NULL 555 157
NULL 555 165
NULL 555 177
NULL 555 237
NULL 555 NULL
NULL 555 NULL
NULL 555 NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       d-e as col2,
       a+b*2+c*3+d*4+e*5 as col3
from t1
where c between b-2 and d+2
   and exists(select 1 from t1 as x where x.b<t1.b)
and b is not null

query IIIII
select a+b*2+c*3 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       e as col3,
       a-b as col4,
       case when c>avg_c then a*2 else b*10 end as col5
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c>d
order by col2,col3,col1,col4,col5
----
793 1985 132 1 1300
827 2046 135 -1 1390
851 2131 144 -1 1430
1030 2579 173 4 1700
1096 2728 180 1 364
1121 2806 189 2 376
1158 2878 192 -3 382
1277 3175 210 2 426
1338 3331 221 -3 440
NULL NULL 117 NULL NULL
738 NULL NULL -3 1240
NULL NULL NULL NULL NULL
NULL NULL NULL NULL NULL

query TTTIT
select e as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       d-e as col3,
       d as col4,
       a+b*2+c*3+d*4 as col5
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col4,col5,col3,col1,col2
----
NULL NULL NULL 101 NULL
109 1050 -1 108 1067
110 1120 4 114 NULL
117 NULL -1 116 NULL
NULL 1240 NULL 122 1226
126 1290 2 128 1272
132 1300 1 133 1325
135 1390 1 136 1371
144 1430 -4 140 1411
162 1600 2 164 1622
173 1700 -2 171 1714
180 364 3 183 1828
189 376 -4 185 1861
192 382 -2 190 1918
197 398 -1 196 1964
204 402 -1 203 NULL
NULL NULL NULL 207 NULL
210 426 2 212 2125
219 432 -2 217 2165
221 440 1 222 2226
227 458 -1 226 2264
230 468 3 233 2323
237 2360 1 238 NULL
246 490 2 248 2476
146 1450 NULL NULL NULL
157 1580 NULL NULL NULL
165 1670 NULL NULL NULL
177 358 NULL NULL NULL
NULL 486 NULL NULL NULL
NULL 1510 NULL NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select e as col1,
       a as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
and d not between 110 and 150

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2 as col1,
       abs(b-c) as col2,
       c as col3,
       d-e as col4,
       a+b*2+c*3+d*4 as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
where (e>c or e<d)
    or (e>a and e<b)
or a is null

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where e+d between a+b-10 and c+130
or c>d

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       d as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4
from t1
where a is null
or d not between 110 and 150

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       c-d as col2,
       a+b*2+c*3 as col3,
       a+b*2+c*3+d*4 as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5
from t1
where (a>b-2 and a<b+2)
    or b is not null
or exists(select 1 from t1 as x where x.b<t1.b)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b as col3,
       abs(a) as col4,
       a as col5
from t1
where b>c
   and coalesce(a,b,c,d,e)<>0
   and (e>a and e<b)
order by col1,col5,col4,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       a+b*2+c*3 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       a-b as col4,
       a+b*2+c*3+d*4+e*5 as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1,
       b-c as col2,
       abs(a) as col3,
       abs(b-c) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       b as col6,
       d-e as col7
from t1
where b is not null
   and e+d between a+b-10 and c+130
   and c between b-2 and d+2
order by col7,col4,col3,col1,col2,col5,col6

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2
from t1
where e+d between a+b-10 and c+130
and exists(select 1 from t1 as x where x.b<t1.b)

query II
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3+d*4 as col2
from t1
order by col1,col2
----
111 1371
111 1411
222 2125
222 NULL
222 NULL
333 1067
333 1226
333 1272
333 1622
333 1828
333 2165
333 NULL
444 1325
444 1861
444 1918
444 2226
444 2476
555 1714
555 1964
555 2264
555 2323
555 NULL
555 NULL
555 NULL
555 NULL
555 NULL
555 NULL
555 NULL
555 NULL
555 NULL

query ITITTII
select case when c>avg_c then a*2 else b*10 end as col1,
       abs(a) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a+b*2 as col4,
       a as col5,
       d-e as col6,
       d as col7
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a is null
   and d>e
order by col2,col1,col4,col7,col3,col5,col6
----
1120 NULL 555 NULL NULL 4 114

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       c-d as col2,
       e as col3,
       a as col4
from t1
where d not between 110 and 150
    or (a>b-2 and a<b+2)
order by col3,col1,col2,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       d as col2
from t1
where b is not null
order by col1,col2

query II
select a+b*2+c*3 as col1,
       c-d as col2
from t1
where b is not null
    or coalesce(a,b,c,d,e)<>0
    or d not between 110 and 150
order by col2,col1
----
760 -3
966 -3
635 -2
1297 -2
1391 -2
1180 -1
1360 -1
1484 -1
NULL -1
NULL -1
738 1
793 1
827 1
851 1
1030 1
1096 1
NULL 1
NULL 1
1121 2
1277 2
1338 2
1158 3
NULL 3
880 NULL
905 NULL
940 NULL
1000 NULL
1057 NULL
1455 NULL
NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select e as col1,
       a+b*2 as col2,
       c as col3,
       b-c as col4
from t1
where a>b
order by col2,col1,col3,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1,
       b-c as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a as col5,
       (a+b+c+d+e)/5 as col6
from t1
where b>c
and (e>a and e<b)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       c-d as col3,
       abs(a) as col4,
       d-e as col5,
       b-c as col6
from t1

query IITIII
select case when c>avg_c then a*2 else b*10 end as col1,
       abs(a) as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       a-b as col4,
       a+b*2 as col5,
       c as col6
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col1,col5,col3,col6,col4,col2
----
358 179 NULL 4 529 176
364 182 2728 1 544 184
376 188 2806 2 560 187
382 191 2878 -3 579 193
398 199 2949 1 595 195
402 201 NULL NULL NULL 202
426 213 3175 2 635 214
432 216 3260 -2 652 215
440 220 3331 -3 666 224
458 229 3399 1 685 225
468 234 3473 2 698 231
486 243 NULL 3 723 244
490 245 3706 -4 743 247
1050 107 1612 2 317 106
1120 NULL NULL NULL NULL 113
1240 121 NULL -3 369 123
1290 127 1902 -2 385 125
1300 131 1985 1 391 134
1390 138 2046 -1 416 137
1430 142 2131 -1 428 141
1450 149 NULL 4 439 147
1510 153 NULL 2 455 150
1580 159 NULL 1 475 155
1600 163 2432 3 483 161
1670 168 NULL 1 502 166
1700 174 2579 4 514 172
2360 239 NULL 3 711 NULL
NULL 104 NULL NULL NULL 102
NULL 115 NULL NULL NULL 119
NULL NULL NULL NULL NULL 208

query IIIII
select c-d as col1,
       b-c as col2,
       a+b*2+c*3 as col3,
       abs(a) as col4,
       a+b*2+c*3+d*4 as col5
from t1
order by col5,col1,col4,col2,col3
----
-2 -1 635 107 1067
1 1 738 121 1226
-3 4 760 127 1272
1 -4 793 131 1325
1 2 827 138 1371
1 2 851 142 1411
-3 -1 966 163 1622
1 -2 1030 174 1714
1 -3 1096 182 1828
2 -1 1121 188 1861
3 1 1158 191 1918
-1 3 1180 199 1964
2 -3 1277 213 2125
-2 3 1297 216 2165
2 -1 1338 220 2226
-1 3 1360 229 2264
-2 1 1391 234 2323
-1 2 1484 245 2476
-1 NULL NULL 201 NULL
-1 -1 NULL NULL NULL
1 NULL NULL 104 NULL
1 -2 NULL NULL NULL
3 NULL NULL 115 NULL
NULL -2 880 149 NULL
NULL 1 905 153 NULL
NULL 3 940 159 NULL
NULL 1 1000 168 NULL
NULL -1 1057 179 NULL
NULL NULL NULL 239 NULL
NULL -4 1455 243 NULL

query I
select d as col1
from t1
where c>d
   and (c<=d-2 or c>=d+2)
   and (e>c or e<d)
order by col1
----
185
212
222

query I
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1
from t1
where b>c
order by col1
----
111
111
333
333
333
444
444
555
555
555
555
555
555

query I
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1
from t1
order by col1
----
111
111
222
222
222
333
333
333
333
333
333
333
444
444
444
444
444
555
555
555
555
555
555
555
555
555
555
555
555
555

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       a+b*2+c*3+d*4 as col2,
       abs(b-c) as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       c-d as col5,
       a+b*2 as col6,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col7
from t1
where e+d between a+b-10 and c+130
or coalesce(a,b,c,d,e)<>0

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where (a>b-2 and a<b+2)
or (e>a and e<b)

query ITITI
select b-c as col1,
       a+b*2+c*3 as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       a+b*2 as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a is null
order by col3,col1,col5,col2,col4
----
-1 NULL 1120 NULL 555
-2 NULL NULL NULL 555

query ITI
select c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       c-d as col3
from t1
order by col1,col3,col2
----
102 NULL 1
106 1612 -2
113 NULL -1
119 NULL 3
123 NULL 1
125 1902 -3
134 1985 1
137 2046 1
141 2131 1
147 NULL NULL
150 NULL NULL
155 NULL NULL
161 2432 -3
166 NULL NULL
172 2579 1
176 NULL NULL
184 2728 1
187 2806 2
193 2878 3
195 2949 -1
202 NULL -1
208 NULL 1
214 3175 2
215 3260 -2
224 3331 2
225 3399 -1
231 3473 -2
244 NULL NULL
247 3706 -1
NULL NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2 as col1,
       d as col2,
       abs(b-c) as col3,
       e as col4
from t1
where (c<=d-2 or c>=d+2)
   and d>e
order by col1,col4,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1
from t1
where c>d
order by col1

query II
select a-b as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (c<=d-2 or c>=d+2)
    or c>d
    or (e>c or e<d)
order by col1,col2
----
-4 490
-3 382
-3 440
-3 1240
-2 432
-2 1290
-1 1390
-1 1430
1 364
1 398
1 458
1 1300
1 1580
2 376
2 426
2 468
2 1050
3 1600
3 2360
4 358
4 1700
NULL 402
NULL 1120
NULL NULL
NULL NULL
NULL NULL

query I
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1
from t1
where a is null
order by col1
----
555
555

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2 as col1,
       d-e as col2,
       a-b as col3,
       abs(a) as col4,
       (a+b+c+d+e)/5 as col5,
       c as col6
from t1
where (c<=d-2 or c>=d+2)
   and c between b-2 and d+2
   and coalesce(a,b,c,d,e)<>0
order by col2,col6,col1,col3,col4,col5

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       b as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where e+d between a+b-10 and c+130
or a>b

query I
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1
from t1
where (e>c or e<d)
order by col1
----
111
111
222
222
333
333
333
333
333
444
444
444
444
555
555
555
555
555
555
555
555

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       d-e as col2
from t1
where e+d between a+b-10 and c+130
and (e>a and e<b)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       c as col2
from t1
where (e>a and e<b)
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a+b*2 as col3,
       a as col4,
       b-c as col5
from t1
where c between b-2 and d+2
and exists(select 1 from t1 as x where x.b<t1.b)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2 as col2,
       a+b*2+c*3 as col3,
       (a+b+c+d+e)/5 as col4,
       d-e as col5
from t1
where (a>b-2 and a<b+2)
    or b>c
order by col3,col2,col5,col4,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       (a+b+c+d+e)/5 as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       c-d as col5
from t1
where d>e
    or a>b
or exists(select 1 from t1 as x where x.b<t1.b)

query I
select e as col1
from t1
order by col1
----
109
110
117
126
132
135
144
146
157
162
165
173
177
180
189
192
197
204
210
219
221
227
230
237
246
NULL
NULL
NULL
NULL
NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2 as col1
from t1
where c>d
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       a+b*2 as col2,
       d-e as col3,
       a+b*2+c*3+d*4 as col4
from t1
where b>c
   and b is not null
   and (a>b-2 and a<b+2)
order by col1,col2,col3,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1,
       abs(b-c) as col2,
       abs(a) as col3
from t1
where a>b
    or exists(select 1 from t1 as x where x.b<t1.b)
or d>e

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       abs(a) as col2
from t1
where (e>c or e<d)
order by col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       (a+b+c+d+e)/5 as col2,
       b-c as col3
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       a+b*2+c*3 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       a-b as col4
from t1
where a>b
   and b>c
and (c<=d-2 or c>=d+2)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       abs(b-c) as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       b-c as col4,
       a+b*2+c*3 as col5,
       a+b*2+c*3+d*4 as col6
from t1
where c>d

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       b-c as col2,
       a+b*2 as col3
from t1
where c between b-2 and d+2
   and a>b
order by col3,col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a+b*2+c*3+d*4 as col3,
       d-e as col4
from t1
where (e>c or e<d)

query I
select case when c>avg_c then a*2 else b*10 end as col1
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a>b
   and coalesce(a,b,c,d,e)<>0
order by col1
----
358
364
376
398
426
458
468
486
1050
1300
1450
1510
1580
1600
1670
1700
2360

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       abs(b-c) as col2,
       a+b*2 as col3
from t1
where (a>b-2 and a<b+2)
order by col2,col1,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       b-c as col3,
       e as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       abs(b-c) as col6
from t1
where a is null
order by col3,col2,col1,col4,col6,col5

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       c-d as col2,
       e as col3
from t1
where d not between 110 and 150
    or (e>a and e<b)
    or a is null
order by col2,col3,col1

query III
select a+b*2+c*3+d*4 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       b-c as col3
from t1
order by col2,col1,col3
----
1371 111 2
1411 111 2
2125 222 -3
NULL 222 -4
NULL 222 NULL
1067 333 -1
1226 333 1
1272 333 4
1622 333 -1
1828 333 -3
2165 333 3
NULL 333 NULL
1325 444 -4
1861 444 -1
1918 444 1
2226 444 -1
2476 444 2
1714 555 -2
1964 555 3
2264 555 3
2323 555 1
NULL 555 -2
NULL 555 -2
NULL 555 -1
NULL 555 -1
NULL 555 1
NULL 555 1
NULL 555 3
NULL 555 NULL
NULL 555 NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       d as col2,
       abs(a) as col3,
       abs(b-c) as col4,
       d-e as col5
from t1
where (e>a and e<b)
    or e+d between a+b-10 and c+130
    or b is not null
order by col1,col3,col2,col4,col5

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       a+b*2+c*3 as col2,
       c as col3
from t1
where b>c
   and a>b
   and e+d between a+b-10 and c+130
order by col3,col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       c-d as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a-b as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6,
       b as col7
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       abs(b-c) as col2
from t1
where b is not null
order by col2,col1

query III
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a as col2,
       case when c>avg_c then a*2 else b*10 end as col3
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
order by col1,col2,col3
----
111 138 1390
111 142 1430
222 201 402
222 213 426
333 107 1050
333 127 1290
333 163 1600
333 182 364
333 216 432
444 131 1300
444 188 376
444 220 440
444 245 490
555 159 1580
555 174 1700
555 179 358
555 199 398
555 229 458
555 234 468
555 239 2360
555 NULL 1120

query IIIIIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a as col2,
       d as col3,
       b-c as col4,
       b as col5,
       a+b*2+c*3+d*4 as col6,
       a+b*2+c*3 as col7
from t1
order by col5,col2,col7,col4,col1,col3,col6
----
333 107 108 -1 105 1067 635
555 NULL 114 -1 112 NULL NULL
333 121 122 1 124 1226 738
333 127 128 4 129 1272 760
444 131 133 -4 130 1325 793
111 138 136 2 139 1371 827
111 142 140 2 143 1411 851
555 149 NULL -2 145 NULL 880
555 153 NULL 1 151 NULL 905
555 159 NULL 3 158 NULL 940
333 163 164 -1 160 1622 966
555 168 NULL 1 167 NULL 1000
555 174 171 -2 170 1714 1030
555 179 NULL -1 175 NULL 1057
333 182 183 -3 181 1828 1096
444 188 185 -1 186 1861 1121
444 191 190 1 194 1918 1158
555 199 196 3 198 1964 1180
555 NULL 207 -2 206 NULL NULL
222 213 212 -3 211 2125 1277
333 216 217 3 218 2165 1297
444 220 222 -1 223 2226 1338
555 229 226 3 228 2264 1360
555 234 233 1 232 2323 1391
555 239 238 NULL 236 NULL NULL
222 243 NULL -4 240 NULL 1455
444 245 248 2 249 2476 1484
555 104 101 NULL NULL NULL NULL
333 115 116 NULL NULL NULL NULL
222 201 203 NULL NULL NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where (a>b-2 and a<b+2)
    or (e>a and e<b)
order by col1

query III
select a+b*2+c*3+d*4+e*5 as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       abs(b-c) as col3
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d not between 110 and 150
    or c between b-2 and d+2
order by col3,col1,col2
----
1612 1050 1
2432 1600 1
2806 376 1
2878 382 1
3331 440 1
3473 468 1
NULL 1120 1
NULL 1240 1
2046 1390 2
2131 1430 2
2579 1700 2
3706 490 2
NULL NULL 2
2728 364 3
2949 398 3
3175 426 3
3260 432 3
3399 458 3
1985 1300 4
NULL 402 NULL
NULL 2360 NULL
NULL NULL NULL

query II
select c as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
    or a>b
order by col2,col1
----
176 358
184 364
187 376
195 398
214 426
225 458
231 468
244 486
106 1050
125 1290
134 1300
147 1450
150 1510
155 1580
161 1600
166 1670
172 1700
NULL 2360

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3+d*4 as col3
from t1
where (a>b-2 and a<b+2)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       b as col3,
       d as col4,
       e as col5,
       c as col6,
       (a+b+c+d+e)/5 as col7
from t1
where d>e
   and (c<=d-2 or c>=d+2)
   and a>b
order by col6,col5,col4,col7,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       e as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4,
       a-b as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and b is not null
and c>d

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3 as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       e as col4,
       d as col5,
       c-d as col6,
       a as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a+b*2 as col3,
       c-d as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6
from t1
where (c<=d-2 or c>=d+2)
or d>e

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and coalesce(a,b,c,d,e)<>0
and c between b-2 and d+2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       d as col2,
       b-c as col3,
       c-d as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       b as col6,
       abs(b-c) as col7
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       a as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       (a+b+c+d+e)/5 as col5
from t1
where (a>b-2 and a<b+2)
   and (e>a and e<b)
and a>b

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a+b*2+c*3 as col3,
       b as col4
from t1
where (a>b-2 and a<b+2)
and d>e

query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       b as col2,
       d-e as col3,
       a+b*2+c*3+d*4 as col4
from t1
order by col3,col2,col1,col4
----
111 143 -4 1411
444 186 -4 1861
555 170 -2 1714
444 194 -2 1918
333 218 -2 2165
333 105 -1 1067
555 198 -1 1964
555 228 -1 2264
222 NULL -1 NULL
333 NULL -1 NULL
444 130 1 1325
111 139 1 1371
444 223 1 2226
555 236 1 NULL
333 129 2 1272
333 160 2 1622
222 211 2 2125
444 249 2 2476
333 181 3 1828
555 232 3 2323
555 112 4 NULL
333 124 NULL 1226
555 145 NULL NULL
555 151 NULL NULL
555 158 NULL NULL
555 167 NULL NULL
555 175 NULL NULL
555 206 NULL NULL
222 240 NULL NULL
555 NULL NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       b-c as col2,
       abs(b-c) as col3,
       b as col4
from t1
where c between b-2 and d+2
order by col4,col1,col3,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(a) as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
or e+d between a+b-10 and c+130

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1
from t1
where a is null
   and (e>c or e<d)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       b-c as col3,
       c-d as col4,
       a+b*2 as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6
from t1
where a>b

query I
select d as col1
from t1
where (e>c or e<d)
order by col1
----
108
114
128
133
136
140
164
171
183
185
196
203
212
217
222
226
233
238
248
NULL
NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where c between b-2 and d+2
   and e+d between a+b-10 and c+130
   and (c<=d-2 or c>=d+2)
order by col1,col2

query IIITI
select a+b*2+c*3 as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2 as col3,
       d as col4,
       c as col5
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
    or a>b
    or (a>b-2 and a<b+2)
order by col2,col4,col5,col3,col1
----
1057 358 529 NULL 176
1096 364 544 183 184
1121 376 560 185 187
1180 398 595 196 195
1277 426 635 212 214
1338 440 666 222 224
1360 458 685 226 225
1391 468 698 233 231
1455 486 723 NULL 244
1484 490 743 248 247
635 1050 317 108 106
NULL 1120 NULL 114 113
738 1240 369 122 123
793 1300 391 133 134
827 1390 416 136 137
851 1430 428 140 141
880 1450 439 NULL 147
905 1510 455 NULL 150
940 1580 475 NULL 155
966 1600 483 164 161
1000 1670 502 NULL 166
1030 1700 514 171 172
NULL 2360 711 238 NULL
NULL NULL NULL 207 208

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       abs(b-c) as col2,
       d as col3,
       a-b as col4,
       a+b*2+c*3+d*4+e*5 as col5,
       a+b*2 as col6,
       abs(a) as col7
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2 as col1,
       d as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       d-e as col4,
       a-b as col5,
       a+b*2+c*3+d*4+e*5 as col6
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       a+b*2+c*3+d*4 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3 as col4,
       c as col5,
       e as col6,
       d as col7
from t1
where a>b
    or (e>c or e<d)
    or b is not null
order by col1,col7,col6,col4,col2,col5,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2 as col1,
       a+b*2+c*3+d*4 as col2
from t1
where d not between 110 and 150
    or b>c
    or (a>b-2 and a<b+2)
order by col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2 as col2
from t1
where b>c

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       e as col2,
       a+b*2 as col3,
       abs(a) as col4,
       c-d as col5
from t1
where coalesce(a,b,c,d,e)<>0
   and c between b-2 and d+2
order by col4,col5,col1,col3,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       d-e as col3
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and c>d
and a>b

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       e as col3,
       b-c as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       a+b*2+c*3 as col6
from t1
where coalesce(a,b,c,d,e)<>0

query I
select a as col1
from t1
where (e>c or e<d)
order by col1
----
107
127
131
138
142
159
163
174
179
182
188
199
201
213
216
220
229
234
239
245
NULL

query IIIII
select a+b*2+c*3 as col1,
       abs(b-c) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       a as col5
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where b is not null
order by col4,col5,col3,col2,col1
----
1057 1 555 358 179
1096 3 333 364 182
1121 1 444 376 188
1158 1 444 382 191
1180 3 555 398 199
1277 3 222 426 213
1297 3 333 432 216
1338 1 444 440 220
1360 3 555 458 229
1391 1 555 468 234
1455 4 222 486 243
1484 2 444 490 245
635 1 333 1050 107
NULL 1 555 1120 NULL
738 1 333 1240 121
760 4 333 1290 127
793 4 444 1300 131
827 2 111 1390 138
851 2 111 1430 142
880 2 555 1450 149
905 1 555 1510 153
940 3 555 1580 159
966 1 333 1600 163
1000 1 555 1670 168
1030 2 555 1700 174
NULL NULL 555 2360 239
NULL 2 555 NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       d-e as col2,
       (a+b+c+d+e)/5 as col3
from t1
where coalesce(a,b,c,d,e)<>0
   and (e>c or e<d)
   and e+d between a+b-10 and c+130
order by col3,col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       abs(b-c) as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where d not between 110 and 150

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       a-b as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       (a+b+c+d+e)/5 as col4,
       c as col5
from t1
where c between b-2 and d+2
    or a>b
or b is not null

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1
from t1
where b is not null
   and e+d between a+b-10 and c+130
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       a+b*2 as col2,
       d as col3,
       a+b*2+c*3+d*4 as col4,
       a-b as col5,
       b-c as col6,
       a as col7
from t1
where b>c
    or a is null
order by col3,col4,col7,col2,col5,col6,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1
from t1
where a>b
order by col1

query IIIIIII
select a+b*2 as col1,
       a as col2,
       b as col3,
       c as col4,
       abs(b-c) as col5,
       abs(a) as col6,
       d as col7
from t1
order by col1,col4,col3,col6,col7,col5,col2
----
317 107 105 106 1 107 108
369 121 124 123 1 121 122
385 127 129 125 4 127 128
391 131 130 134 4 131 133
416 138 139 137 2 138 136
428 142 143 141 2 142 140
439 149 145 147 2 149 NULL
455 153 151 150 1 153 NULL
475 159 158 155 3 159 NULL
483 163 160 161 1 163 164
502 168 167 166 1 168 NULL
514 174 170 172 2 174 171
529 179 175 176 1 179 NULL
544 182 181 184 3 182 183
560 188 186 187 1 188 185
579 191 194 193 1 191 190
595 199 198 195 3 199 196
635 213 211 214 3 213 212
652 216 218 215 3 216 217
666 220 223 224 1 220 222
685 229 228 225 3 229 226
698 234 232 231 1 234 233
711 239 236 NULL NULL 239 238
723 243 240 244 4 243 NULL
743 245 249 247 2 245 248
NULL 104 NULL 102 NULL 104 101
NULL NULL 112 113 1 NULL 114
NULL 115 NULL 119 NULL 115 116
NULL 201 NULL 202 NULL 201 203
NULL NULL 206 208 2 NULL 207

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       abs(a) as col2
from t1
where b is not null
    or e+d between a+b-10 and c+130
    or c between b-2 and d+2
order by col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       b-c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       c as col4
from t1
where d not between 110 and 150
   and (a>b-2 and a<b+2)
   and a>b
order by col4,col1,col3,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       d-e as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       a-b as col4,
       abs(b-c) as col5,
       d as col6
from t1
where (c<=d-2 or c>=d+2)
    or e+d between a+b-10 and c+130
or a>b

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       d as col2,
       e as col3,
       a+b*2+c*3+d*4 as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       b-c as col6,
       a as col7
from t1
where c between b-2 and d+2
and exists(select 1 from t1 as x where x.b<t1.b)

query IIIII
select d-e as col1,
       abs(b-c) as col2,
       a+b*2+c*3 as col3,
       a+b*2 as col4,
       a-b as col5
from t1
where coalesce(a,b,c,d,e)<>0
order by col2,col4,col3,col1,col5
----
-1 1 635 317 2
NULL 1 738 369 -3
NULL 1 905 455 2
2 1 966 483 3
NULL 1 1000 502 1
NULL 1 1057 529 4
-4 1 1121 560 2
-2 1 1158 579 -3
1 1 1338 666 -3
3 1 1391 698 2
4 1 NULL NULL NULL
1 2 827 416 -1
-4 2 851 428 -1
NULL 2 880 439 4
-2 2 1030 514 4
2 2 1484 743 -4
NULL 2 NULL NULL NULL
NULL 3 940 475 1
3 3 1096 544 1
-1 3 1180 595 1
2 3 1277 635 2
-2 3 1297 652 -2
-1 3 1360 685 1
2 4 760 385 -2
1 4 793 391 1
NULL 4 1455 723 3
1 NULL NULL 711 3
-1 NULL NULL NULL NULL
-1 NULL NULL NULL NULL
NULL NULL NULL NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       b as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d-e as col4
from t1
where (c<=d-2 or c>=d+2)
    or (e>c or e<d)
or c>d

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       c-d as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a+b*2+c*3 as col4,
       d-e as col5
from t1
where a>b
   and (e>c or e<d)
   and a is null
order by col5,col3,col2,col4,col1

query TTIII
select a+b*2+c*3 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       d as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       abs(b-c) as col5
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
   and a is null
   and d>e
order by col1,col2,col3,col5,col4
----
NULL NULL 114 1120 1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       b-c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       a+b*2+c*3+d*4 as col5,
       c as col6,
       a as col7
from t1
where (c<=d-2 or c>=d+2)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       a+b*2+c*3 as col4,
       b-c as col5,
       e as col6
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5
from t1
where d not between 110 and 150
    or d>e
or coalesce(a,b,c,d,e)<>0

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a-b as col3,
       c-d as col4
from t1
where (a>b-2 and a<b+2)
   and (c<=d-2 or c>=d+2)
order by col3,col2,col1,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       d-e as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a+b*2+c*3 as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1,
       b as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       a+b*2+c*3 as col4,
       e as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       b as col3
from t1
where c>d
order by col1,col3,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       (a+b+c+d+e)/5 as col2,
       d as col3
from t1
where (e>a and e<b)
   and a is null
order by col3,col2,col1

query I
select b as col1
from t1
where e+d between a+b-10 and c+130
    or (c<=d-2 or c>=d+2)
order by col1
----
105
129
160
186
194
211
218
223
232
NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       c-d as col3,
       b-c as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       a+b*2+c*3+d*4 as col6
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       d as col5
from t1
where c between b-2 and d+2
   and d>e
and coalesce(a,b,c,d,e)<>0

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2
from t1
where c between b-2 and d+2
and d>e

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       (a+b+c+d+e)/5 as col2,
       a+b*2 as col3,
       c as col4,
       b as col5,
       d as col6
from t1
where e+d between a+b-10 and c+130
   and (c<=d-2 or c>=d+2)
order by col4,col6,col2,col1,col5,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       a as col2
from t1
where b>c
   and (e>c or e<d)
   and (a>b-2 and a<b+2)
order by col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       a+b*2+c*3+d*4 as col2,
       a+b*2+c*3 as col3,
       d-e as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       a-b as col6
from t1
where coalesce(a,b,c,d,e)<>0
   and d>e
   and d not between 110 and 150
order by col6,col4,col5,col2,col3,col1

query I
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
order by col1
----
111
222
222
222
222
222
222
222
333
333
333
333
333
333
333
333
333
333
333
444
444
444
444
444
444
444
444
444
444
444

query IIII
select a+b*2+c*3+d*4 as col1,
       d as col2,
       d-e as col3,
       a-b as col4
from t1
order by col4,col1,col3,col2
----
2476 248 2 -4
1226 122 NULL -3
1918 190 -2 -3
2226 222 1 -3
1272 128 2 -2
2165 217 -2 -2
1371 136 1 -1
1411 140 -4 -1
1325 133 1 1
1828 183 3 1
1964 196 -1 1
2264 226 -1 1
NULL NULL NULL 1
NULL NULL NULL 1
1067 108 -1 2
1861 185 -4 2
2125 212 2 2
2323 233 3 2
NULL NULL NULL 2
1622 164 2 3
NULL 238 1 3
NULL NULL NULL 3
1714 171 -2 4
NULL NULL NULL 4
NULL NULL NULL 4
NULL 116 -1 NULL
NULL 203 -1 NULL
NULL 114 4 NULL
NULL 101 NULL NULL
NULL 207 NULL NULL

query II
select d-e as col1,
       a-b as col2
from t1
order by col1,col2
----
-4 -1
-4 2
-2 -3
-2 -2
-2 4
-1 1
-1 1
-1 2
-1 NULL
-1 NULL
1 -3
1 -1
1 1
1 3
2 -4
2 -2
2 2
2 3
3 1
3 2
4 NULL
NULL -3
NULL 1
NULL 1
NULL 2
NULL 3
NULL 4
NULL 4
NULL NULL
NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       a+b*2+c*3 as col2,
       c-d as col3
from t1
where (c<=d-2 or c>=d+2)
   and b is not null
   and c>d
order by col2,col1,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       d-e as col3
from t1
where a>b

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       d-e as col2,
       a-b as col3,
       (a+b+c+d+e)/5 as col4,
       b as col5,
       a as col6,
       abs(b-c) as col7
from t1
where d>e
   and b is not null
   and coalesce(a,b,c,d,e)<>0
order by col5,col2,col3,col1,col4,col7,col6

query IIII
select a as col1,
       d as col2,
       a-b as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
order by col4,col2,col3,col1
----
245 248 -4 111
121 122 -3 222
127 128 -2 222
138 136 -1 222
142 140 -1 222
191 190 -3 222
216 217 -2 222
220 222 -3 222
107 108 2 333
131 133 1 333
182 183 1 333
188 185 2 333
199 196 1 333
213 212 2 333
229 226 1 333
234 233 2 333
159 NULL 1 333
168 NULL 1 333
153 NULL 2 333
104 101 NULL 444
NULL 114 NULL 444
115 116 NULL 444
163 164 3 444
174 171 4 444
201 203 NULL 444
NULL 207 NULL 444
239 238 3 444
243 NULL 3 444
149 NULL 4 444
179 NULL 4 444

query TIIT
select d as col1,
       c as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       a+b*2+c*3+d*4+e*5 as col4
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col3,col1,col4,col2
----
NULL 176 358 NULL
183 184 364 2728
185 187 376 2806
190 193 382 2878
196 195 398 2949
203 202 402 NULL
212 214 426 3175
217 215 432 3260
222 224 440 3331
226 225 458 3399
233 231 468 3473
NULL 244 486 NULL
248 247 490 3706
108 106 1050 1612
114 113 1120 NULL
122 123 1240 NULL
128 125 1290 1902
133 134 1300 1985
136 137 1390 2046
140 141 1430 2131
NULL 147 1450 NULL
NULL 150 1510 NULL
NULL 155 1580 NULL
164 161 1600 2432
NULL 166 1670 NULL
171 172 1700 2579
238 NULL 2360 NULL
101 102 NULL NULL
116 119 NULL NULL
207 208 NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       a+b*2 as col6
from t1
where a>b

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       b as col3
from t1
where a>b
order by col1,col2,col3

query II
select abs(a) as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d not between 110 and 150
order by col2,col1
----
182 364
188 376
191 382
199 398
201 402
213 426
216 432
220 440
229 458
234 468
245 490
107 1050
163 1600
174 1700
239 2360
104 NULL
NULL NULL

query III
select a-b as col1,
       b-c as col2,
       abs(b-c) as col3
from t1
order by col1,col3,col2
----
-4 2 2
-3 -1 1
-3 1 1
-3 1 1
-2 3 3
-2 4 4
-1 2 2
-1 2 2
1 1 1
1 -3 3
1 3 3
1 3 3
1 3 3
1 -4 4
2 -1 1
2 -1 1
2 1 1
2 1 1
2 -3 3
3 -1 1
3 -4 4
3 NULL NULL
4 -1 1
4 -2 2
4 -2 2
NULL -1 1
NULL -2 2
NULL NULL NULL
NULL NULL NULL
NULL NULL NULL

query I
select c as col1
from t1
where (e>c or e<d)
    or a>b
order by col1
----
106
113
125
134
137
141
147
150
155
161
166
172
176
184
187
195
202
214
215
224
225
231
244
247
NULL

query FIIIII
select (a+b+c+d+e)/5 as col1,
       c-d as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       a as col5,
       c as col6
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
order by col2,col6,col5,col1,col4,col3
----
127.0 -3 222 1290 127 125
162.0 -3 444 1600 163 161
107.0 -2 333 1050 107 106
217.0 -2 222 432 216 215
232.0 -2 333 468 234 231
NULL -1 444 1120 NULL 113
197.0 -1 333 398 199 195
NULL -1 444 402 201 202
227.0 -1 333 458 229 225
247.0 -1 111 490 245 247
132.0 1 333 1300 131 134
137.0 1 222 1390 138 137
142.0 1 222 1430 142 141
172.0 1 444 1700 174 172
182.0 1 333 364 182 184
187.0 2 333 376 188 187
212.0 2 333 426 213 214
222.0 2 222 440 220 224
NULL NULL 333 1580 159 155
NULL NULL 444 358 179 176
NULL NULL 444 2360 239 NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1
from t1
where (a>b-2 and a<b+2)
   and d>e
and b>c

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2 as col1
from t1
where (e>c or e<d)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       c as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2 as col4
from t1
where d>e
order by col1,col3,col2,col4

query I
select d as col1
from t1
where e+d between a+b-10 and c+130
    or b>c
    or c>d
order by col1
----
101
108
116
122
128
133
136
140
171
183
185
190
196
207
212
217
222
226
233
248
NULL
NULL
NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1,
       e as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       d-e as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5
from t1
where a>b
order by col1,col5,col2,col4,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       b-c as col2,
       e as col3
from t1
where d not between 110 and 150
    or a>b
order by col2,col1,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       d as col2,
       a as col3,
       c as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       a+b*2+c*3+d*4+e*5 as col6,
       abs(a) as col7
from t1
where d>e
    or a is null
order by col6,col1,col2,col4,col5,col7,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       c as col2,
       c-d as col3,
       b-c as col4
from t1
where c between b-2 and d+2
    or a>b
    or b is not null
order by col2,col4,col1,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       b-c as col2,
       a+b*2 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       abs(a) as col5
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a+b*2 as col3,
       c as col4,
       d as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6,
       a-b as col7
from t1
where e+d between a+b-10 and c+130
and (c<=d-2 or c>=d+2)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2
from t1
where (e>c or e<d)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       b as col2,
       e as col3
from t1
where (a>b-2 and a<b+2)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1
from t1
where (e>a and e<b)
   and c>d
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       (a+b+c+d+e)/5 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       b as col4,
       c-d as col5
from t1
where coalesce(a,b,c,d,e)<>0

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       abs(b-c) as col4
from t1
where (e>c or e<d)
    or coalesce(a,b,c,d,e)<>0
or exists(select 1 from t1 as x where x.b<t1.b)

query TTIIT
select a-b as col1,
       b as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       abs(a) as col4,
       a+b*2 as col5
from t1
order by col4,col5,col1,col3,col2
----
NULL NULL 444 104 NULL
2 105 333 107 317
NULL NULL 444 115 NULL
-3 124 222 121 369
-2 129 222 127 385
1 130 333 131 391
-1 139 222 138 416
-1 143 222 142 428
4 145 444 149 439
2 151 333 153 455
1 158 333 159 475
3 160 444 163 483
1 167 333 168 502
4 170 444 174 514
4 175 444 179 529
1 181 333 182 544
2 186 333 188 560
-3 194 222 191 579
1 198 333 199 595
NULL NULL 444 201 NULL
2 211 333 213 635
-2 218 222 216 652
-3 223 222 220 666
1 228 333 229 685
2 232 333 234 698
3 236 444 239 711
3 240 444 243 723
-4 249 111 245 743
NULL 112 444 NULL NULL
NULL 206 444 NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       abs(b-c) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       a+b*2+c*3 as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col7
from t1
where (e>c or e<d)
or b is not null

query I
select c as col1
from t1
where b>c
    or b is not null
    or (e>c or e<d)
order by col1
----
106
113
123
125
134
137
141
147
150
155
161
166
172
176
184
187
193
195
202
208
214
215
224
225
231
244
247
NULL

query IIII
select d-e as col1,
       c-d as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a+b*2 as col4
from t1
order by col1,col2,col3,col4
----
-4 1 111 428
-4 2 444 560
-2 -2 333 652
-2 1 555 514
-2 3 444 579
-1 -2 333 317
-1 -1 222 NULL
-1 -1 555 595
-1 -1 555 685
-1 3 333 NULL
1 1 111 416
1 1 444 391
1 2 444 666
1 NULL 555 711
2 -3 333 385
2 -3 333 483
2 -1 444 743
2 2 222 635
3 -2 555 698
3 1 333 544
4 -1 555 NULL
NULL 1 333 369
NULL 1 555 NULL
NULL 1 555 NULL
NULL NULL 222 723
NULL NULL 555 439
NULL NULL 555 455
NULL NULL 555 475
NULL NULL 555 502
NULL NULL 555 529

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       d as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       a+b*2+c*3+d*4 as col4,
       c as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where a is null

query I
select case when c>avg_c then a*2 else b*10 end as col1
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col1
----
358
364
376
382
398
402
426
432
440
458
468
486
490
1050
1120
1240
1290
1300
1390
1430
1450
1510
1580
1600
1670
1700
2360
NULL
NULL
NULL

query I
select d-e as col1
from t1
order by col1
----
-4
-4
-2
-2
-2
-1
-1
-1
-1
-1
1
1
1
1
2
2
2
2
3
3
4
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query IIIIII
select b-c as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       c-d as col4,
       e as col5,
       b as col6
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
    or a is null
    or c between b-2 and d+2
order by col2,col4,col5,col1,col6,col3
----
-3 364 333 1 180 181
-1 376 333 2 189 186
-3 426 333 2 210 211
-1 440 222 2 221 223
1 468 333 -2 230 232
2 490 111 -1 246 249
-1 1050 333 -2 109 105
-1 1120 444 -1 110 112
1 1240 222 1 NULL 124
4 1290 222 -3 126 129
-4 1300 333 1 132 130
2 1390 222 1 135 139
2 1430 222 1 144 143
-1 1600 444 -3 162 160
-2 1700 444 1 173 170
-2 NULL 444 1 NULL 206

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       abs(a) as col2,
       a+b*2 as col3,
       a as col4
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       b-c as col3,
       a+b*2+c*3+d*4 as col4
from t1
where (e>c or e<d)
   and exists(select 1 from t1 as x where x.b<t1.b)
and b>c

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2+c*3+d*4+e*5 as col2
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1
from t1
where coalesce(a,b,c,d,e)<>0
   and d>e
order by col1

query IIIIII
select d-e as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3 as col3,
       a-b as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       abs(b-c) as col6
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where coalesce(a,b,c,d,e)<>0
    or c between b-2 and d+2
    or (c<=d-2 or c>=d+2)
order by col2,col4,col1,col5,col3,col6
----
2 111 1484 -4 490 2
-2 222 1158 -3 382 1
1 222 1338 -3 440 1
NULL 222 738 -3 1240 1
-2 222 1297 -2 432 3
2 222 760 -2 1290 4
-4 222 851 -1 1430 2
1 222 827 -1 1390 2
-1 333 1180 1 398 3
-1 333 1360 1 458 3
1 333 793 1 1300 4
3 333 1096 1 364 3
NULL 333 940 1 1580 3
NULL 333 1000 1 1670 1
-4 333 1121 2 376 1
-1 333 635 2 1050 1
2 333 1277 2 426 3
3 333 1391 2 468 1
NULL 333 905 2 1510 1
1 444 NULL 3 2360 NULL
2 444 966 3 1600 1
NULL 444 1455 3 486 4
-2 444 1030 4 1700 2
NULL 444 1057 4 358 1
NULL 444 880 4 1450 2
-1 444 NULL NULL 402 NULL
-1 444 NULL NULL NULL NULL
4 444 NULL NULL 1120 1
NULL 444 NULL NULL NULL 2
NULL 444 NULL NULL NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4,
       b as col5,
       a+b*2+c*3 as col6,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col7
from t1
where e+d between a+b-10 and c+130

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select e as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       c-d as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       d as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col7
from t1

query III
select c-d as col1,
       a-b as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3
from t1
order by col2,col3,col1
----
-1 -4 444
1 -3 333
2 -3 444
3 -3 444
-3 -2 333
-2 -2 333
1 -1 111
1 -1 111
1 1 333
1 1 444
-1 1 555
-1 1 555
NULL 1 555
NULL 1 555
2 2 222
-2 2 333
2 2 444
-2 2 555
NULL 2 555
NULL 3 222
-3 3 333
NULL 3 555
1 4 555
NULL 4 555
NULL 4 555
-1 NULL 222
3 NULL 333
-1 NULL 555
1 NULL 555
1 NULL 555

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2+c*3+d*4 as col2,
       c-d as col3,
       a as col4,
       b-c as col5,
       a+b*2 as col6,
       d-e as col7
from t1
where (e>a and e<b)
    or b is not null
or exists(select 1 from t1 as x where x.b<t1.b)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       abs(a) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       c-d as col2,
       c as col3,
       d-e as col4,
       abs(a) as col5,
       b-c as col6
from t1
where b is not null
    or (e>c or e<d)
    or d not between 110 and 150
order by col6,col5,col2,col3,col4,col1

query I
select a+b*2+c*3+d*4 as col1
from t1
order by col1
----
1067
1226
1272
1325
1371
1411
1622
1714
1828
1861
1918
1964
2125
2165
2226
2264
2323
2476
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I
select c-d as col1
from t1
where coalesce(a,b,c,d,e)<>0
order by col1
----
-3
-3
-2
-2
-2
-1
-1
-1
-1
-1
1
1
1
1
1
1
1
1
2
2
2
3
3
NULL
NULL
NULL
NULL
NULL
NULL
NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       b as col2,
       a-b as col3,
       e as col4,
       c as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6
from t1
where a>b
or b is not null

query IIIIII
select case when c>avg_c then a*2 else b*10 end as col1,
       d as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a+b*2 as col4,
       e as col5,
       a+b*2+c*3+d*4+e*5 as col6
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d not between 110 and 150
    or e+d between a+b-10 and c+130
    or a>b
order by col4,col1,col2,col3,col6,col5
----
1050 108 333 317 109 1612
1290 128 333 385 126 1902
1300 133 444 391 132 1985
1450 NULL 555 439 146 NULL
1510 NULL 555 455 NULL NULL
1580 NULL 555 475 157 NULL
1600 164 333 483 162 2432
1670 NULL 555 502 165 NULL
1700 171 555 514 173 2579
358 NULL 555 529 177 NULL
364 183 333 544 180 2728
376 185 444 560 189 2806
382 190 444 579 192 2878
398 196 555 595 197 2949
426 212 222 635 210 3175
432 217 333 652 219 3260
440 222 444 666 221 3331
458 226 555 685 227 3399
468 233 555 698 230 3473
2360 238 555 711 237 NULL
486 NULL 222 723 NULL NULL
490 248 444 743 246 3706
402 203 222 NULL 204 NULL
NULL 101 555 NULL NULL NULL
NULL 207 555 NULL NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2
from t1
where b>c
or exists(select 1 from t1 as x where x.b<t1.b)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       e as col2,
       b as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       a+b*2+c*3+d*4 as col6
from t1
where a>b
    or e+d between a+b-10 and c+130
or d not between 110 and 150

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       e as col2,
       b-c as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where (e>c or e<d)
order by col1,col2,col4,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       d as col2,
       a-b as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4
from t1
where c>d
    or exists(select 1 from t1 as x where x.b<t1.b)
or (e>a and e<b)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where c between b-2 and d+2
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       a-b as col2,
       c-d as col3,
       a+b*2+c*3 as col4,
       e as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where (e>a and e<b)
    or a is null
order by col3,col1,col2,col4,col5,col6

query I
select a as col1
from t1
order by col1
----
104
107
115
121
127
131
138
142
149
153
159
163
168
174
179
182
188
191
199
201
213
216
220
229
234
239
243
245
NULL
NULL

query ITITT
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       a+b*2 as col2,
       abs(a) as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       d-e as col5
from t1
order by col3,col2,col1,col4,col5
----
444 NULL 104 NULL NULL
333 317 107 1612 -1
444 NULL 115 NULL -1
222 369 121 NULL NULL
222 385 127 1902 2
333 391 131 1985 1
222 416 138 2046 1
222 428 142 2131 -4
444 439 149 NULL NULL
333 455 153 NULL NULL
333 475 159 NULL NULL
444 483 163 2432 2
333 502 168 NULL NULL
444 514 174 2579 -2
444 529 179 NULL NULL
333 544 182 2728 3
333 560 188 2806 -4
222 579 191 2878 -2
333 595 199 2949 -1
444 NULL 201 NULL -1
333 635 213 3175 2
222 652 216 3260 -2
222 666 220 3331 1
333 685 229 3399 -1
333 698 234 3473 3
444 711 239 NULL 1
444 723 243 NULL NULL
111 743 245 3706 2
444 NULL NULL NULL 4
444 NULL NULL NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       a as col4,
       abs(b-c) as col5,
       abs(a) as col6,
       c-d as col7
from t1
where c between b-2 and d+2

query III
select case when c>avg_c then a*2 else b*10 end as col1,
       d-e as col2,
       c-d as col3
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col2,col1,col3
----
376 -4 2
1430 -4 1
382 -2 3
432 -2 -2
1700 -2 1
398 -1 -1
402 -1 -1
458 -1 -1
1050 -1 -2
NULL -1 3
440 1 2
1300 1 1
1390 1 1
2360 1 NULL
426 2 2
490 2 -1
1290 2 -3
1600 2 -3
364 3 1
468 3 -2
1120 4 -1
358 NULL NULL
486 NULL NULL
1240 NULL 1
1450 NULL NULL
1510 NULL NULL
1580 NULL NULL
1670 NULL NULL
NULL NULL 1
NULL NULL 1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a-b as col2,
       (a+b+c+d+e)/5 as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       d as col5,
       c-d as col6
from t1
where coalesce(a,b,c,d,e)<>0

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1,
       a+b*2 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4
from t1
where b>c
    or c>d
or a>b

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       b-c as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       c as col4,
       e as col5,
       abs(a) as col6,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col7
from t1
where a is null
or (e>a and e<b)

query IIIIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3 as col2,
       b-c as col3,
       abs(a) as col4,
       a-b as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
order by col3,col5,col6,col1,col4,col2
----
444 793 -4 131 1 333
222 1455 -4 243 3 444
333 1096 -3 182 1 333
222 1277 -3 213 2 333
555 880 -2 149 4 444
555 1030 -2 174 4 444
555 NULL -2 NULL NULL 444
444 1338 -1 220 -3 222
333 635 -1 107 2 333
444 1121 -1 188 2 333
333 966 -1 163 3 444
555 1057 -1 179 4 444
555 NULL -1 NULL NULL 444
333 738 1 121 -3 222
444 1158 1 191 -3 222
555 1000 1 168 1 333
555 905 1 153 2 333
555 1391 1 234 2 333
444 1484 2 245 -4 111
111 827 2 138 -1 222
111 851 2 142 -1 222
333 1297 3 216 -2 222
555 940 3 159 1 333
555 1180 3 199 1 333
555 1360 3 229 1 333
333 760 4 127 -2 222
555 NULL NULL 239 3 444
222 NULL NULL 201 NULL 444
333 NULL NULL 115 NULL 444
555 NULL NULL 104 NULL 444

query III
select e as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       d as col3
from t1
order by col1,col2,col3
----
109 1612 108
110 NULL 114
117 NULL 116
126 1902 128
132 1985 133
135 2046 136
144 2131 140
146 NULL NULL
157 NULL NULL
162 2432 164
165 NULL NULL
173 2579 171
177 NULL NULL
180 2728 183
189 2806 185
192 2878 190
197 2949 196
204 NULL 203
210 3175 212
219 3260 217
221 3331 222
227 3399 226
230 3473 233
237 NULL 238
246 3706 248
NULL NULL 101
NULL NULL 122
NULL NULL 207
NULL NULL NULL
NULL NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       e as col4,
       b-c as col5,
       d-e as col6,
       abs(a) as col7
from t1
where (c<=d-2 or c>=d+2)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       abs(a) as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where a is null
and a>b

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       c-d as col2,
       d as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5,
       a+b*2+c*3+d*4 as col6
from t1
where (c<=d-2 or c>=d+2)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       a+b*2+c*3 as col2,
       a+b*2+c*3+d*4 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b as col5
from t1
where b is not null
or d>e

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       b as col4,
       abs(b-c) as col5
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (c<=d-2 or c>=d+2)
   and c>d
   and a is null
order by col1,col4,col5,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       e as col3
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a as col3,
       c as col4,
       e as col5,
       a+b*2+c*3 as col6
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       abs(a) as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       a+b*2+c*3+d*4+e*5 as col4
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       abs(b-c) as col2,
       b as col3,
       abs(a) as col4,
       a as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6,
       (select count(*) from t1 as x where x.b<t1.b) as col7
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       e as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a-b as col4,
       c-d as col5,
       abs(a) as col6
from t1
where e+d between a+b-10 and c+130
order by col4,col2,col3,col5,col1,col6

query F
select (a+b+c+d+e)/5 as col1
from t1
order by col1
----
107.0
127.0
132.0
137.0
142.0
162.0
172.0
182.0
187.0
192.0
197.0
212.0
217.0
222.0
227.0
232.0
247.0
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2 as col1,
       c-d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5
from t1
where (e>a and e<b)
    or (c<=d-2 or c>=d+2)
or c between b-2 and d+2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select e as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5
from t1
where a is null

query II
select d as col1,
       c-d as col2
from t1
order by col2,col1
----
128 -3
164 -3
108 -2
217 -2
233 -2
114 -1
196 -1
203 -1
226 -1
248 -1
101 1
122 1
133 1
136 1
140 1
171 1
183 1
207 1
185 2
212 2
222 2
116 3
190 3
238 NULL
NULL NULL
NULL NULL
NULL NULL
NULL NULL
NULL NULL
NULL NULL

query II
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a as col2
from t1
where b>c
   and a>b
   and coalesce(a,b,c,d,e)<>0
order by col2,col1
----
555 153
555 159
555 168
555 199
555 229
555 234

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       (a+b+c+d+e)/5 as col2,
       e as col3,
       a+b*2 as col4,
       c-d as col5,
       a as col6,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col7
from t1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select e as col1,
       d-e as col2,
       a+b*2+c*3+d*4 as col3,
       c as col4,
       d as col5,
       a-b as col6,
       abs(b-c) as col7
from t1
where e+d between a+b-10 and c+130
order by col4,col2,col7,col6,col3,col5,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       d as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where (c<=d-2 or c>=d+2)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       a+b*2+c*3 as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       e as col4
from t1
where c>d
    or a is null
or (e>c or e<d)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       (a+b+c+d+e)/5 as col2,
       b-c as col3,
       a+b*2 as col4
from t1
where e+d between a+b-10 and c+130
   and d not between 110 and 150
order by col3,col2,col1,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       a+b*2+c*3 as col5
from t1
where b is not null

query IIII
select c as col1,
       a+b*2+c*3 as col2,
       b-c as col3,
       a-b as col4
from t1
order by col4,col2,col1,col3
----
247 1484 2 -4
123 738 1 -3
193 1158 1 -3
224 1338 -1 -3
125 760 4 -2
215 1297 3 -2
137 827 2 -1
141 851 2 -1
134 793 -4 1
155 940 3 1
166 1000 1 1
184 1096 -3 1
195 1180 3 1
225 1360 3 1
106 635 -1 2
150 905 1 2
187 1121 -1 2
214 1277 -3 2
231 1391 1 2
161 966 -1 3
244 1455 -4 3
NULL NULL NULL 3
147 880 -2 4
172 1030 -2 4
176 1057 -1 4
102 NULL NULL NULL
113 NULL -1 NULL
119 NULL NULL NULL
202 NULL NULL NULL
208 NULL -2 NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1
from t1
where (e>c or e<d)
   and d>e
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3+d*4 as col3,
       a-b as col4,
       c-d as col5
from t1

query IIIIIII
select a+b*2+c*3+d*4 as col1,
       abs(b-c) as col2,
       d-e as col3,
       abs(a) as col4,
       a as col5,
       e as col6,
       c-d as col7
from t1
order by col6,col7,col2,col5,col1,col4,col3
----
1067 1 -1 107 107 109 -2
NULL 1 4 NULL NULL 110 -1
NULL NULL -1 115 115 117 3
1272 4 2 127 127 126 -3
1325 4 1 131 131 132 1
1371 2 1 138 138 135 1
1411 2 -4 142 142 144 1
NULL 2 NULL 149 149 146 NULL
NULL 3 NULL 159 159 157 NULL
1622 1 2 163 163 162 -3
NULL 1 NULL 168 168 165 NULL
1714 2 -2 174 174 173 1
NULL 1 NULL 179 179 177 NULL
1828 3 3 182 182 180 1
1861 1 -4 188 188 189 2
1918 1 -2 191 191 192 3
1964 3 -1 199 199 197 -1
NULL NULL -1 201 201 204 -1
2125 3 2 213 213 210 2
2165 3 -2 216 216 219 -2
2226 1 1 220 220 221 2
2264 3 -1 229 229 227 -1
2323 1 3 234 234 230 -2
NULL NULL 1 239 239 237 NULL
2476 2 2 245 245 246 -1
1226 1 NULL 121 121 NULL 1
NULL 2 NULL NULL NULL NULL 1
NULL NULL NULL 104 104 NULL 1
NULL 1 NULL 153 153 NULL NULL
NULL 4 NULL 243 243 NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (c<=d-2 or c>=d+2)
and (e>c or e<d)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2 as col1,
       (a+b+c+d+e)/5 as col2,
       c as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       abs(b-c) as col6,
       e as col7
from t1
where a>b
    or a is null
or b is not null

query IIFI
select a+b*2+c*3 as col1,
       d-e as col2,
       (a+b+c+d+e)/5 as col3,
       a+b*2+c*3+d*4+e*5 as col4
from t1
order by col1,col4,col2,col3
----
635 -1 107.0 1612
738 NULL NULL NULL
760 2 127.0 1902
793 1 132.0 1985
827 1 137.0 2046
851 -4 142.0 2131
880 NULL NULL NULL
905 NULL NULL NULL
940 NULL NULL NULL
966 2 162.0 2432
1000 NULL NULL NULL
1030 -2 172.0 2579
1057 NULL NULL NULL
1096 3 182.0 2728
1121 -4 187.0 2806
1158 -2 192.0 2878
1180 -1 197.0 2949
1277 2 212.0 3175
1297 -2 217.0 3260
1338 1 222.0 3331
1360 -1 227.0 3399
1391 3 232.0 3473
1455 NULL NULL NULL
1484 2 247.0 3706
NULL -1 NULL NULL
NULL -1 NULL NULL
NULL 1 NULL NULL
NULL 4 NULL NULL
NULL NULL NULL NULL
NULL NULL NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       abs(b-c) as col3,
       a+b*2 as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where b>c

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where c between b-2 and d+2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1
from t1
where (e>a and e<b)
order by col1

query III
select b as col1,
       c-d as col2,
       case when c>avg_c then a*2 else b*10 end as col3
from (
 select a, b, c, d, e, avg_c
 from (
    select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d not between 110 and 150
order by col2,col1,col3
----
160 -3 1600
105 -2 1050
218 -2 432
232 -2 468
198 -1 398
228 -1 458
249 -1 490
NULL -1 402
170 1 1700
181 1 364
206 1 NULL
NULL 1 NULL
186 2 376
211 2 426
223 2 440
194 3 382
236 NULL 2360

