statement ok
drop table if exists t1 all

statement ok
create table t1(a integer null, b integer null, c integer null, d integer null, e integer null)

statement ok
insert into t1(e,c,b,d,a) values(null,102,null,101,104)

statement ok
insert into t1(a,c,d,e,b) values(107,106,108,109,105)

statement ok
insert into t1(e,d,b,a,c) values(110,114,112,null,113)

statement ok
insert into t1(d,c,e,a,b) values(116,119,117,115,null)

statement ok
insert into t1(c,d,b,e,a) values(123,122,124,null,121)

statement ok
insert into t1(a,d,b,e,c) values(127,128,129,126,125)

statement ok
insert into t1(e,c,a,d,b) values(132,134,131,133,130)

statement ok
insert into t1(a,d,b,e,c) values(138,136,139,135,137)

statement ok
insert into t1(e,c,d,a,b) values(144,141,140,142,143)

statement ok
insert into t1(b,a,e,d,c) values(145,149,146,null,147)

statement ok
insert into t1(b,c,a,d,e) values(151,150,153,null,null)

statement ok
insert into t1(c,e,a,d,b) values(155,157,159,null,158)

statement ok
insert into t1(c,b,a,d,e) values(161,160,163,164,162)

statement ok
insert into t1(b,d,a,e,c) values(167,null,168,165,166)

statement ok
insert into t1(d,b,c,e,a) values(171,170,172,173,174)

statement ok
insert into t1(e,c,a,d,b) values(177,176,179,null,175)

statement ok
insert into t1(b,e,a,d,c) values(181,180,182,183,184)

statement ok
insert into t1(c,a,b,e,d) values(187,188,186,189,185)

statement ok
insert into t1(d,b,c,e,a) values(190,194,193,192,191)

statement ok
insert into t1(a,e,b,d,c) values(199,197,198,196,195)

statement ok
insert into t1(b,c,d,a,e) values(null,202,203,201,204)

statement ok
insert into t1(c,e,a,b,d) values(208,null,null,206,207)

statement ok
insert into t1(c,e,a,d,b) values(214,210,213,212,211)

statement ok
insert into t1(b,c,a,d,e) values(218,215,216,217,219)

statement ok
insert into t1(b,e,d,a,c) values(223,221,222,220,224)

statement ok
insert into t1(d,e,b,a,c) values(226,227,228,229,225)

statement ok
insert into t1(a,c,b,e,d) values(234,231,232,230,233)

statement ok
insert into t1(e,b,a,c,d) values(237,236,239,null,238)

statement ok
insert into t1(e,c,b,a,d) values(null,244,240,243,null)

statement ok
insert into t1(e,d,c,b,a) values(246,248,247,249,245)

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3
from t1
where (e>c or e<d)
   and d>e
   and d not between 110 and 150
order by col3,col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3
from t1
where d>e
   and d not between 110 and 150
   and (e>c or e<d)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3
from t1
where d>e
   and d not between 110 and 150
   and (e>c or e<d)
order by col1,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3
from t1
where d>e
   and (e>c or e<d)
   and d not between 110 and 150
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3
from t1
where d>e
   and (e>c or e<d)
   and d not between 110 and 150
order by col2,col1,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       abs(a) as col4,
       a as col5,
       abs(b-c) as col6,
       c as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       abs(a) as col4,
       a as col5,
       abs(b-c) as col6,
       c as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col3,col2,col6,col7,col4,col5,col1

query IIIIII
select a+b*2+c*3 as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       e as col3,
       a-b as col4,
       d as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a>b
   and c between b-2 and d+2
order by col6,col4,col5,col2,col3,col1
----
1277 426 210 2 212 222
1096 364 180 1 183 333
635 1050 109 2 108 333
966 1600 162 3 164 333
793 1300 132 1 133 444
1121 376 189 2 185 444
1391 468 230 2 233 555
1030 1700 173 4 171 555

query IIIIII
select a+b*2+c*3 as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       e as col3,
       a-b as col4,
       d as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a>b
   and c between b-2 and d+2
order by col4,col6,col1,col2,col5,col3
----
1096 364 180 1 183 333
793 1300 132 1 133 444
1277 426 210 2 212 222
635 1050 109 2 108 333
1121 376 189 2 185 444
1391 468 230 2 233 555
966 1600 162 3 164 333
1030 1700 173 4 171 555

query IIIIII
select a+b*2+c*3 as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       e as col3,
       a-b as col4,
       d as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
   and a>b
order by col6,col4,col5,col2,col3,col1
----
1277 426 210 2 212 222
1096 364 180 1 183 333
635 1050 109 2 108 333
966 1600 162 3 164 333
793 1300 132 1 133 444
1121 376 189 2 185 444
1391 468 230 2 233 555
1030 1700 173 4 171 555

query IIIIII
select a+b*2+c*3 as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       e as col3,
       a-b as col4,
       d as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
   and a>b
order by col6,col5,col2,col3,col4,col1
----
1277 426 210 2 212 222
635 1050 109 2 108 333
966 1600 162 3 164 333
1096 364 180 1 183 333
793 1300 132 1 133 444
1121 376 189 2 185 444
1030 1700 173 4 171 555
1391 468 230 2 233 555

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       c-d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       a as col4,
       a+b*2+c*3 as col5,
       a-b as col6,
       a+b*2+c*3+d*4 as col7
from t1
where (e>c or e<d)
    or b>c
    or (a>b-2 and a<b+2)
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       c-d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       a as col4,
       a+b*2+c*3 as col5,
       a-b as col6,
       a+b*2+c*3+d*4 as col7
from t1
where (e>c or e<d)
    or b>c
    or (a>b-2 and a<b+2)
order by col5,col1,col3,col6,col7,col4,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       c-d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       a as col4,
       a+b*2+c*3 as col5,
       a-b as col6,
       a+b*2+c*3+d*4 as col7
from t1
where b>c
    or (e>c or e<d)
    or (a>b-2 and a<b+2)
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       c-d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       a as col4,
       a+b*2+c*3 as col5,
       a-b as col6,
       a+b*2+c*3+d*4 as col7
from t1
where b>c
    or (e>c or e<d)
    or (a>b-2 and a<b+2)
order by col3,col1,col2,col6,col4,col7,col5

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       c-d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       a as col4,
       a+b*2+c*3 as col5,
       a-b as col6,
       a+b*2+c*3+d*4 as col7
from t1
where b>c
    or (a>b-2 and a<b+2)
    or (e>c or e<d)
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       c-d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       a as col4,
       a+b*2+c*3 as col5,
       a-b as col6,
       a+b*2+c*3+d*4 as col7
from t1
where b>c
    or (a>b-2 and a<b+2)
    or (e>c or e<d)
order by col5,col7,col3,col6,col4,col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3+d*4 as col2,
       a as col3,
       e as col4,
       a+b*2 as col5,
       c as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
where c between b-2 and d+2
    or (a>b-2 and a<b+2)
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3+d*4 as col2,
       a as col3,
       e as col4,
       a+b*2 as col5,
       c as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
where c between b-2 and d+2
    or (a>b-2 and a<b+2)
order by col3,col1,col2,col7,col6,col4,col5

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3+d*4 as col2,
       a as col3,
       e as col4,
       a+b*2 as col5,
       c as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
where (a>b-2 and a<b+2)
    or c between b-2 and d+2
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3+d*4 as col2,
       a as col3,
       e as col4,
       a+b*2 as col5,
       c as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
where (a>b-2 and a<b+2)
    or c between b-2 and d+2
order by col7,col2,col6,col3,col1,col5,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       e as col2,
       a-b as col3
from t1
where c between b-2 and d+2
   and b>c
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       e as col2,
       a-b as col3
from t1
where c between b-2 and d+2
   and b>c
order by col3,col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       e as col2,
       a-b as col3
from t1
where b>c
   and c between b-2 and d+2
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       e as col2,
       a-b as col3
from t1
where b>c
   and c between b-2 and d+2
order by col1,col3,col2

query IIIII
select a+b*2+c*3+d*4 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       abs(a) as col3,
       a+b*2+c*3 as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
order by col4,col5,col2,col3,col1
----
1067 333 107 635 1612
1226 222 121 738 NULL
1272 222 127 760 1902
1325 333 131 793 1985
1371 222 138 827 2046
1411 222 142 851 2131
NULL 444 149 880 NULL
NULL 333 153 905 NULL
NULL 333 159 940 NULL
1622 444 163 966 2432
NULL 333 168 1000 NULL
1714 444 174 1030 2579
NULL 444 179 1057 NULL
1828 333 182 1096 2728
1861 333 188 1121 2806
1918 222 191 1158 2878
1964 333 199 1180 2949
2125 333 213 1277 3175
2165 222 216 1297 3260
2226 222 220 1338 3331
2264 333 229 1360 3399
2323 333 234 1391 3473
NULL 444 243 1455 NULL
2476 111 245 1484 3706
NULL 444 104 NULL NULL
NULL 444 115 NULL NULL
NULL 444 201 NULL NULL
NULL 444 239 NULL NULL
NULL 444 NULL NULL NULL
NULL 444 NULL NULL NULL

query IIIII
select a+b*2+c*3+d*4 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       abs(a) as col3,
       a+b*2+c*3 as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
order by col5,col2,col4,col3,col1
----
1067 333 107 635 1612
1272 222 127 760 1902
1325 333 131 793 1985
1371 222 138 827 2046
1411 222 142 851 2131
1622 444 163 966 2432
1714 444 174 1030 2579
1828 333 182 1096 2728
1861 333 188 1121 2806
1918 222 191 1158 2878
1964 333 199 1180 2949
2125 333 213 1277 3175
2165 222 216 1297 3260
2226 222 220 1338 3331
2264 333 229 1360 3399
2323 333 234 1391 3473
2476 111 245 1484 3706
1226 222 121 738 NULL
NULL 333 153 905 NULL
NULL 333 159 940 NULL
NULL 333 168 1000 NULL
NULL 444 149 880 NULL
NULL 444 179 1057 NULL
NULL 444 243 1455 NULL
NULL 444 104 NULL NULL
NULL 444 115 NULL NULL
NULL 444 201 NULL NULL
NULL 444 239 NULL NULL
NULL 444 NULL NULL NULL
NULL 444 NULL NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       abs(a) as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       a+b*2 as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       abs(a) as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       a+b*2 as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col4,col2,col3

query I
select c as col1
from t1
where a>b
order by col1
----
106
134
147
150
155
161
166
172
176
184
187
195
214
225
231
244
NULL

query I
select c as col1
from t1
where a>b
order by col1
----
106
134
147
150
155
161
166
172
176
184
187
195
214
225
231
244
NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       abs(a) as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       abs(b-c) as col5
from t1
where e+d between a+b-10 and c+130
    or (e>a and e<b)
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       abs(a) as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       abs(b-c) as col5
from t1
where e+d between a+b-10 and c+130
    or (e>a and e<b)
order by col5,col4,col3,col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       abs(a) as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       abs(b-c) as col5
from t1
where (e>a and e<b)
    or e+d between a+b-10 and c+130
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       abs(a) as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       abs(b-c) as col5
from t1
where (e>a and e<b)
    or e+d between a+b-10 and c+130
order by col3,col2,col4,col5,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1
from t1
where d not between 110 and 150
    or (e>c or e<d)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1
from t1
where d not between 110 and 150
    or (e>c or e<d)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1
from t1
where (e>c or e<d)
    or d not between 110 and 150
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1
from t1
where (e>c or e<d)
    or d not between 110 and 150
order by col1

query IIIII
select a+b*2+c*3+d*4+e*5 as col1,
       e as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a-b as col4,
       d-e as col5
from t1
order by col4,col5,col2,col3,col1
----
3706 246 444 -4 2
2878 192 444 -3 -2
3331 221 444 -3 1
NULL NULL 333 -3 NULL
3260 219 333 -2 -2
1902 126 333 -2 2
2131 144 111 -1 -4
2046 135 111 -1 1
2949 197 555 1 -1
3399 227 555 1 -1
1985 132 444 1 1
2728 180 333 1 3
NULL 157 555 1 NULL
NULL 165 555 1 NULL
2806 189 444 2 -4
1612 109 333 2 -1
3175 210 222 2 2
3473 230 555 2 3
NULL NULL 555 2 NULL
NULL 237 555 3 1
2432 162 333 3 2
NULL NULL 222 3 NULL
2579 173 555 4 -2
NULL 146 555 4 NULL
NULL 177 555 4 NULL
NULL 117 333 NULL -1
NULL 204 222 NULL -1
NULL 110 555 NULL 4
NULL NULL 555 NULL NULL
NULL NULL 555 NULL NULL

query IIIII
select a+b*2+c*3+d*4+e*5 as col1,
       e as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a-b as col4,
       d-e as col5
from t1
order by col1,col5,col3,col4,col2
----
1612 109 333 2 -1
1902 126 333 -2 2
1985 132 444 1 1
2046 135 111 -1 1
2131 144 111 -1 -4
2432 162 333 3 2
2579 173 555 4 -2
2728 180 333 1 3
2806 189 444 2 -4
2878 192 444 -3 -2
2949 197 555 1 -1
3175 210 222 2 2
3260 219 333 -2 -2
3331 221 444 -3 1
3399 227 555 1 -1
3473 230 555 2 3
3706 246 444 -4 2
NULL 204 222 NULL -1
NULL 117 333 NULL -1
NULL 237 555 3 1
NULL 110 555 NULL 4
NULL NULL 222 3 NULL
NULL NULL 333 -3 NULL
NULL 157 555 1 NULL
NULL 165 555 1 NULL
NULL NULL 555 2 NULL
NULL 146 555 4 NULL
NULL 177 555 4 NULL
NULL NULL 555 NULL NULL
NULL NULL 555 NULL NULL

query ITIITI
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       d as col2,
       a-b as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       d-e as col5,
       b-c as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col6,col4,col5,col2,col3,col1
----
444 NULL 3 486 NULL -4
333 133 1 1300 1 -4
333 183 1 364 3 -3
333 212 2 426 2 -3
444 NULL 4 1450 NULL -2
444 171 4 1700 -2 -2
444 207 NULL NULL NULL -2
444 NULL 4 358 NULL -1
333 185 2 376 -4 -1
222 222 -3 440 1 -1
333 108 2 1050 -1 -1
444 114 NULL 1120 4 -1
444 164 3 1600 2 -1
222 190 -3 382 -2 1
333 233 2 468 3 1
222 122 -3 1240 NULL 1
333 NULL 2 1510 NULL 1
333 NULL 1 1670 NULL 1
111 248 -4 490 2 2
222 136 -1 1390 1 2
222 140 -1 1430 -4 2
333 196 1 398 -1 3
222 217 -2 432 -2 3
333 226 1 458 -1 3
333 NULL 1 1580 NULL 3
222 128 -2 1290 2 4
444 203 NULL 402 -1 NULL
444 238 3 2360 1 NULL
444 116 NULL NULL -1 NULL
444 101 NULL NULL NULL NULL

query IITTTT
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       d as col2,
       a-b as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       d-e as col5,
       b-c as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col2,col1,col6,col4,col5,col3
----
444 101 NULL NULL NULL NULL
333 108 2 1050 -1 -1
444 114 NULL 1120 4 -1
444 116 NULL NULL -1 NULL
222 122 -3 1240 NULL 1
222 128 -2 1290 2 4
333 133 1 1300 1 -4
222 136 -1 1390 1 2
222 140 -1 1430 -4 2
444 164 3 1600 2 -1
444 171 4 1700 -2 -2
333 183 1 364 3 -3
333 185 2 376 -4 -1
222 190 -3 382 -2 1
333 196 1 398 -1 3
444 203 NULL 402 -1 NULL
444 207 NULL NULL NULL -2
333 212 2 426 2 -3
222 217 -2 432 -2 3
222 222 -3 440 1 -1
333 226 1 458 -1 3
333 233 2 468 3 1
444 238 3 2360 1 NULL
111 248 -4 490 2 2
333 NULL 2 1510 NULL 1
333 NULL 1 1670 NULL 1
333 NULL 1 1580 NULL 3
444 NULL 3 486 NULL -4
444 NULL 4 1450 NULL -2
444 NULL 4 358 NULL -1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       a-b as col2,
       c as col3,
       abs(b-c) as col4
from t1
where d>e
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       a-b as col2,
       c as col3,
       abs(b-c) as col4
from t1
where d>e
order by col2,col3,col4,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or c between b-2 and d+2
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or c between b-2 and d+2
order by col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2
from t1
where c between b-2 and d+2
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2
from t1
where c between b-2 and d+2
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       c as col2,
       a-b as col3
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       c as col2,
       a-b as col3
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col3,col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       (a+b+c+d+e)/5 as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       a+b*2+c*3+d*4 as col4,
       abs(b-c) as col5
from t1
where b>c
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       (a+b+c+d+e)/5 as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       a+b*2+c*3+d*4 as col4,
       abs(b-c) as col5
from t1
where b>c
order by col2,col3,col4,col5,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1
from t1
where b>c
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1
from t1
where b>c
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       b as col2
from t1
where e+d between a+b-10 and c+130
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       b as col2
from t1
where e+d between a+b-10 and c+130
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select e as col1,
       b-c as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select e as col1,
       b-c as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
order by col1,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       d as col2,
       b as col3,
       a as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where d not between 110 and 150
    or (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       d as col2,
       b as col3,
       a as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where d not between 110 and 150
    or (c<=d-2 or c>=d+2)
order by col5,col3,col2,col1,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       d as col2,
       b as col3,
       a as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where (c<=d-2 or c>=d+2)
    or d not between 110 and 150
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       d as col2,
       b as col3,
       a as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where (c<=d-2 or c>=d+2)
    or d not between 110 and 150
order by col2,col3,col5,col1,col4

query I
select b-c as col1
from t1
order by col1
----
-4
-4
-3
-3
-2
-2
-2
-1
-1
-1
-1
-1
-1
1
1
1
1
1
2
2
2
3
3
3
3
4
NULL
NULL
NULL
NULL

query I
select b-c as col1
from t1
order by col1
----
-4
-4
-3
-3
-2
-2
-2
-1
-1
-1
-1
-1
-1
1
1
1
1
1
2
2
2
3
3
3
3
4
NULL
NULL
NULL
NULL

query FIIIII
select (a+b+c+d+e)/5 as col1,
       b-c as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       a as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a-b as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col6,col4,col5,col2,col3,col1
----
247.0 2 3706 245 490 -4
NULL 1 NULL 121 1240 -3
192.0 1 2878 191 382 -3
222.0 -1 3331 220 440 -3
127.0 4 1902 127 1290 -2
217.0 3 3260 216 432 -2
137.0 2 2046 138 1390 -1
142.0 2 2131 142 1430 -1
132.0 -4 1985 131 1300 1
NULL 3 NULL 159 1580 1
NULL 1 NULL 168 1670 1
182.0 -3 2728 182 364 1
197.0 3 2949 199 398 1
227.0 3 3399 229 458 1
107.0 -1 1612 107 1050 2
NULL 1 NULL 153 1510 2
187.0 -1 2806 188 376 2
212.0 -3 3175 213 426 2
232.0 1 3473 234 468 2
162.0 -1 2432 163 1600 3
NULL NULL NULL 239 2360 3
NULL -4 NULL 243 486 3
NULL -2 NULL 149 1450 4
172.0 -2 2579 174 1700 4
NULL -1 NULL 179 358 4
NULL NULL NULL 104 NULL NULL
NULL NULL NULL 115 NULL NULL
NULL NULL NULL 201 402 NULL
NULL -1 NULL NULL 1120 NULL
NULL -2 NULL NULL NULL NULL

query TITIII
select (a+b+c+d+e)/5 as col1,
       b-c as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       a as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a-b as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col5,col1,col6,col4,col2,col3
----
NULL -1 NULL 179 358 4
182.0 -3 2728 182 364 1
187.0 -1 2806 188 376 2
192.0 1 2878 191 382 -3
197.0 3 2949 199 398 1
NULL NULL NULL 201 402 NULL
212.0 -3 3175 213 426 2
217.0 3 3260 216 432 -2
222.0 -1 3331 220 440 -3
227.0 3 3399 229 458 1
232.0 1 3473 234 468 2
NULL -4 NULL 243 486 3
247.0 2 3706 245 490 -4
107.0 -1 1612 107 1050 2
NULL -1 NULL NULL 1120 NULL
NULL 1 NULL 121 1240 -3
127.0 4 1902 127 1290 -2
132.0 -4 1985 131 1300 1
137.0 2 2046 138 1390 -1
142.0 2 2131 142 1430 -1
NULL -2 NULL 149 1450 4
NULL 1 NULL 153 1510 2
NULL 3 NULL 159 1580 1
162.0 -1 2432 163 1600 3
NULL 1 NULL 168 1670 1
172.0 -2 2579 174 1700 4
NULL NULL NULL 239 2360 3
NULL NULL NULL 104 NULL NULL
NULL NULL NULL 115 NULL NULL
NULL -2 NULL NULL NULL NULL

query IIIIII
select c as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       b-c as col4,
       d-e as col5,
       a+b*2+c*3 as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col6,col4,col5,col2,col3,col1
----
106 1050 333 -1 -1 635
123 1240 333 1 NULL 738
125 1290 333 4 2 760
134 1300 444 -4 1 793
137 1390 111 2 1 827
141 1430 111 2 -4 851
147 1450 555 -2 NULL 880
150 1510 555 1 NULL 905
155 1580 555 3 NULL 940
161 1600 333 -1 2 966
166 1670 555 1 NULL 1000
172 1700 555 -2 -2 1030
176 358 555 -1 NULL 1057
184 364 333 -3 3 1096
187 376 444 -1 -4 1121
193 382 444 1 -2 1158
195 398 555 3 -1 1180
214 426 222 -3 2 1277
215 432 333 3 -2 1297
224 440 444 -1 1 1338
225 458 555 3 -1 1360
231 468 555 1 3 1391
244 486 222 -4 NULL 1455
247 490 444 2 2 1484
208 NULL 555 -2 NULL NULL
113 1120 555 -1 4 NULL
202 402 222 NULL -1 NULL
119 NULL 333 NULL -1 NULL
NULL 2360 555 NULL 1 NULL
102 NULL 555 NULL NULL NULL

query IIIIII
select c as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       b-c as col4,
       d-e as col5,
       a+b*2+c*3 as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col3,col6,col2,col1,col4,col5
----
137 1390 111 2 1 827
141 1430 111 2 -4 851
214 426 222 -3 2 1277
244 486 222 -4 NULL 1455
202 402 222 NULL -1 NULL
106 1050 333 -1 -1 635
123 1240 333 1 NULL 738
125 1290 333 4 2 760
161 1600 333 -1 2 966
184 364 333 -3 3 1096
215 432 333 3 -2 1297
119 NULL 333 NULL -1 NULL
134 1300 444 -4 1 793
187 376 444 -1 -4 1121
193 382 444 1 -2 1158
224 440 444 -1 1 1338
247 490 444 2 2 1484
147 1450 555 -2 NULL 880
150 1510 555 1 NULL 905
155 1580 555 3 NULL 940
166 1670 555 1 NULL 1000
172 1700 555 -2 -2 1030
176 358 555 -1 NULL 1057
195 398 555 3 -1 1180
225 458 555 3 -1 1360
231 468 555 1 3 1391
113 1120 555 -1 4 NULL
NULL 2360 555 NULL 1 NULL
102 NULL 555 NULL NULL NULL
208 NULL 555 -2 NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       c-d as col3
from t1
where c>d
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(a) as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       c-d as col3
from t1
where c>d
order by col2,col1,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1,
       abs(b-c) as col2,
       a+b*2+c*3+d*4 as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a-b as col5,
       d-e as col6,
       a+b*2 as col7
from t1
where c between b-2 and d+2
    or (e>c or e<d)
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1,
       abs(b-c) as col2,
       a+b*2+c*3+d*4 as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a-b as col5,
       d-e as col6,
       a+b*2 as col7
from t1
where c between b-2 and d+2
    or (e>c or e<d)
order by col6,col2,col3,col4,col7,col1,col5

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2 as col1,
       c-d as col2,
       d-e as col3,
       abs(a) as col4,
       a-b as col5,
       c as col6,
       b as col7
from t1
where a>b
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2 as col1,
       c-d as col2,
       d-e as col3,
       abs(a) as col4,
       a-b as col5,
       c as col6,
       b as col7
from t1
where a>b
order by col1,col6,col2,col5,col3,col7,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       c as col2,
       a+b*2 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       d-e as col5,
       a+b*2+c*3+d*4+e*5 as col6,
       a-b as col7
from t1
where (e>c or e<d)
    or (e>a and e<b)
    or c>d
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       c as col2,
       a+b*2 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       d-e as col5,
       a+b*2+c*3+d*4+e*5 as col6,
       a-b as col7
from t1
where (e>c or e<d)
    or (e>a and e<b)
    or c>d
order by col2,col7,col6,col5,col4,col1,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       c as col2,
       a+b*2 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       d-e as col5,
       a+b*2+c*3+d*4+e*5 as col6,
       a-b as col7
from t1
where (e>a and e<b)
    or (e>c or e<d)
    or c>d
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       c as col2,
       a+b*2 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       d-e as col5,
       a+b*2+c*3+d*4+e*5 as col6,
       a-b as col7
from t1
where (e>a and e<b)
    or (e>c or e<d)
    or c>d
order by col6,col3,col7,col4,col5,col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       e as col2,
       a+b*2 as col3,
       a+b*2+c*3+d*4 as col4,
       abs(a) as col5,
       abs(b-c) as col6
from t1
where c>d
    or d not between 110 and 150
    or a>b
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       e as col2,
       a+b*2 as col3,
       a+b*2+c*3+d*4 as col4,
       abs(a) as col5,
       abs(b-c) as col6
from t1
where c>d
    or d not between 110 and 150
    or a>b
order by col1,col3,col6,col4,col2,col5

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       e as col2,
       a+b*2 as col3,
       a+b*2+c*3+d*4 as col4,
       abs(a) as col5,
       abs(b-c) as col6
from t1
where c>d
    or a>b
    or d not between 110 and 150
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       e as col2,
       a+b*2 as col3,
       a+b*2+c*3+d*4 as col4,
       abs(a) as col5,
       abs(b-c) as col6
from t1
where c>d
    or a>b
    or d not between 110 and 150
order by col1,col5,col2,col6,col4,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       e as col2,
       a+b*2 as col3,
       a+b*2+c*3+d*4 as col4,
       abs(a) as col5,
       abs(b-c) as col6
from t1
where a>b
    or c>d
    or d not between 110 and 150
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1,
       e as col2,
       a+b*2 as col3,
       a+b*2+c*3+d*4 as col4,
       abs(a) as col5,
       abs(b-c) as col6
from t1
where a>b
    or c>d
    or d not between 110 and 150
order by col6,col1,col4,col5,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1
from t1
where d>e
    or c between b-2 and d+2
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1
from t1
where d>e
    or c between b-2 and d+2
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1
from t1
where c between b-2 and d+2
    or d>e
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d-e as col1
from t1
where c between b-2 and d+2
    or d>e
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       c as col2,
       a+b*2+c*3+d*4 as col3
from t1
where (e>a and e<b)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (a+b+c+d+e)/5 as col1,
       c as col2,
       a+b*2+c*3+d*4 as col3
from t1
where (e>a and e<b)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where (e>a and e<b)
   and d>e
   and b>c
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where (e>a and e<b)
   and d>e
   and b>c
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where (e>a and e<b)
   and b>c
   and d>e
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where (e>a and e<b)
   and b>c
   and d>e
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where d>e
   and b>c
   and (e>a and e<b)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where d>e
   and b>c
   and (e>a and e<b)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where b>c
   and d>e
   and (e>a and e<b)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a-b as col1
from t1
where b>c
   and d>e
   and (e>a and e<b)
order by col1

query I
select abs(a) as col1
from t1
order by col1
----
104
107
115
121
127
131
138
142
149
153
159
163
168
174
179
182
188
191
199
201
213
216
220
229
234
239
243
245
NULL
NULL

query I
select abs(a) as col1
from t1
order by col1
----
104
107
115
121
127
131
138
142
149
153
159
163
168
174
179
182
188
191
199
201
213
216
220
229
234
239
243
245
NULL
NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       d as col2,
       a-b as col3,
       abs(a) as col4,
       c as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where c between b-2 and d+2
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       d as col2,
       a-b as col3,
       abs(a) as col4,
       c as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where c between b-2 and d+2
order by col3,col2,col4,col6,col5,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d as col4,
       d-e as col5
from t1
where (e>c or e<d)
   and (a>b-2 and a<b+2)
   and d>e
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d as col4,
       d-e as col5
from t1
where (e>c or e<d)
   and (a>b-2 and a<b+2)
   and d>e
order by col2,col4,col5,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d as col4,
       d-e as col5
from t1
where d>e
   and (e>c or e<d)
   and (a>b-2 and a<b+2)
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d as col4,
       d-e as col5
from t1
where d>e
   and (e>c or e<d)
   and (a>b-2 and a<b+2)
order by col5,col1,col2,col4,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d as col4,
       d-e as col5
from t1
where (a>b-2 and a<b+2)
   and (e>c or e<d)
   and d>e
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select abs(b-c) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d as col4,
       d-e as col5
from t1
where (a>b-2 and a<b+2)
   and (e>c or e<d)
   and d>e
order by col2,col4,col3,col5,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       c-d as col3
from t1
where (a>b-2 and a<b+2)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       c-d as col3
from t1
where (a>b-2 and a<b+2)
order by col2,col1,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where a>b
   and (a>b-2 and a<b+2)
   and c between b-2 and d+2
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where a>b
   and (a>b-2 and a<b+2)
   and c between b-2 and d+2
order by col2,col1,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where c between b-2 and d+2
   and a>b
   and (a>b-2 and a<b+2)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where c between b-2 and d+2
   and a>b
   and (a>b-2 and a<b+2)
order by col2,col1,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where (a>b-2 and a<b+2)
   and c between b-2 and d+2
   and a>b
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where (a>b-2 and a<b+2)
   and c between b-2 and d+2
   and a>b
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where (a>b-2 and a<b+2)
   and a>b
   and c between b-2 and d+2
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b-c as col1,
       e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where (a>b-2 and a<b+2)
   and a>b
   and c between b-2 and d+2
order by col2,col1,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       abs(b-c) as col2,
       a+b*2+c*3+d*4 as col3,
       a+b*2+c*3 as col4,
       d-e as col5
from t1
where c between b-2 and d+2
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       abs(b-c) as col2,
       a+b*2+c*3+d*4 as col3,
       a+b*2+c*3 as col4,
       d-e as col5
from t1
where c between b-2 and d+2
order by col3,col1,col4,col2,col5

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3 as col2
from t1
where d not between 110 and 150
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3 as col2
from t1
where d not between 110 and 150
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3 as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or d not between 110 and 150
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3 as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or d not between 110 and 150
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where (e>c or e<d)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where (e>c or e<d)
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d as col4
from t1
where c>d
   and b>c
   and (e>c or e<d)
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d as col4
from t1
where c>d
   and b>c
   and (e>c or e<d)
order by col1,col2,col4,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d as col4
from t1
where c>d
   and (e>c or e<d)
   and b>c
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d as col4
from t1
where c>d
   and (e>c or e<d)
   and b>c
order by col1,col2,col4,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d as col4
from t1
where (e>c or e<d)
   and c>d
   and b>c
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d as col4
from t1
where (e>c or e<d)
   and c>d
   and b>c
order by col1,col3,col2,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d as col4
from t1
where (e>c or e<d)
   and b>c
   and c>d
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d as col4
from t1
where (e>c or e<d)
   and b>c
   and c>d
order by col2,col3,col1,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       b as col2,
       e as col3
from t1
where d>e
    or e+d between a+b-10 and c+130
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       b as col2,
       e as col3
from t1
where d>e
    or e+d between a+b-10 and c+130
order by col1,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       b as col2,
       e as col3
from t1
where e+d between a+b-10 and c+130
    or d>e
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4+e*5 as col1,
       b as col2,
       e as col3
from t1
where e+d between a+b-10 and c+130
    or d>e
order by col1,col2,col3

query IIIII
select abs(a) as col1,
       c as col2,
       c-d as col3,
       a-b as col4,
       abs(b-c) as col5
from t1
order by col4,col5,col2,col3,col1
----
245 247 -1 -4 2
121 123 1 -3 1
191 193 3 -3 1
220 224 2 -3 1
216 215 -2 -2 3
127 125 -3 -2 4
138 137 1 -1 2
142 141 1 -1 2
168 166 NULL 1 1
159 155 NULL 1 3
182 184 1 1 3
199 195 -1 1 3
229 225 -1 1 3
131 134 1 1 4
107 106 -2 2 1
153 150 NULL 2 1
188 187 2 2 1
234 231 -2 2 1
213 214 2 2 3
163 161 -3 3 1
243 244 NULL 3 4
239 NULL NULL 3 NULL
179 176 NULL 4 1
149 147 NULL 4 2
174 172 1 4 2
NULL 113 -1 NULL 1
NULL 208 1 NULL 2
104 102 1 NULL NULL
115 119 3 NULL NULL
201 202 -1 NULL NULL

query IIIII
select abs(a) as col1,
       c as col2,
       c-d as col3,
       a-b as col4,
       abs(b-c) as col5
from t1
order by col3,col2,col4,col5,col1
----
127 125 -3 -2 4
163 161 -3 3 1
107 106 -2 2 1
216 215 -2 -2 3
234 231 -2 2 1
NULL 113 -1 NULL 1
199 195 -1 1 3
201 202 -1 NULL NULL
229 225 -1 1 3
245 247 -1 -4 2
104 102 1 NULL NULL
121 123 1 -3 1
131 134 1 1 4
138 137 1 -1 2
142 141 1 -1 2
174 172 1 4 2
182 184 1 1 3
NULL 208 1 NULL 2
188 187 2 2 1
213 214 2 2 3
220 224 2 -3 1
115 119 3 NULL NULL
191 193 3 -3 1
149 147 NULL 4 2
153 150 NULL 2 1
159 155 NULL 1 3
168 166 NULL 1 1
179 176 NULL 4 1
243 244 NULL 3 4
239 NULL NULL 3 NULL

query IIII
select a+b*2+c*3 as col1,
       e as col2,
       a+b*2 as col3,
       b-c as col4
from t1
order by col4,col2,col3,col1
----
793 132 391 -4
1455 NULL 723 -4
1096 180 544 -3
1277 210 635 -3
880 146 439 -2
1030 173 514 -2
NULL NULL NULL -2
635 109 317 -1
NULL 110 NULL -1
966 162 483 -1
1057 177 529 -1
1121 189 560 -1
1338 221 666 -1
1000 165 502 1
1158 192 579 1
1391 230 698 1
738 NULL 369 1
905 NULL 455 1
827 135 416 2
851 144 428 2
1484 246 743 2
940 157 475 3
1180 197 595 3
1297 219 652 3
1360 227 685 3
760 126 385 4
NULL 117 NULL NULL
NULL 204 NULL NULL
NULL 237 711 NULL
NULL NULL NULL NULL

query IIII
select a+b*2+c*3 as col1,
       e as col2,
       a+b*2 as col3,
       b-c as col4
from t1
order by col2,col4,col3,col1
----
635 109 317 -1
NULL 110 NULL -1
NULL 117 NULL NULL
760 126 385 4
793 132 391 -4
827 135 416 2
851 144 428 2
880 146 439 -2
940 157 475 3
966 162 483 -1
1000 165 502 1
1030 173 514 -2
1057 177 529 -1
1096 180 544 -3
1121 189 560 -1
1158 192 579 1
1180 197 595 3
NULL 204 NULL NULL
1277 210 635 -3
1297 219 652 3
1338 221 666 -1
1360 227 685 3
1391 230 698 1
NULL 237 711 NULL
1484 246 743 2
1455 NULL 723 -4
NULL NULL NULL -2
738 NULL 369 1
905 NULL 455 1
NULL NULL NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4
from t1
where (e>a and e<b)
    or c>d
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4
from t1
where (e>a and e<b)
    or c>d
order by col3,col1,col2,col4

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4
from t1
where c>d
    or (e>a and e<b)
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4
from t1
where c>d
    or (e>a and e<b)
order by col2,col3,col1,col4

query IIIIFII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       abs(a) as col2,
       d as col3,
       a+b*2+c*3+d*4 as col4,
       (a+b+c+d+e)/5 as col5,
       e as col6,
       a-b as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1
----
333 107 108 1067 107.0 109 2
444 NULL 114 NULL NULL 110 NULL
444 115 116 NULL NULL 117 NULL
222 127 128 1272 127.0 126 -2
333 131 133 1325 132.0 132 1
222 138 136 1371 137.0 135 -1
222 142 140 1411 142.0 144 -1
444 149 NULL NULL NULL 146 4
333 159 NULL NULL NULL 157 1
444 163 164 1622 162.0 162 3
333 168 NULL NULL NULL 165 1
444 174 171 1714 172.0 173 4
444 179 NULL NULL NULL 177 4
333 182 183 1828 182.0 180 1
333 188 185 1861 187.0 189 2
222 191 190 1918 192.0 192 -3
333 199 196 1964 197.0 197 1
444 201 203 NULL NULL 204 NULL
333 213 212 2125 212.0 210 2
222 216 217 2165 217.0 219 -2
222 220 222 2226 222.0 221 -3
333 229 226 2264 227.0 227 1
333 234 233 2323 232.0 230 2
444 239 238 NULL NULL 237 3
111 245 248 2476 247.0 246 -4
222 121 122 1226 NULL NULL -3
333 153 NULL NULL NULL NULL 2
444 243 NULL NULL NULL NULL 3
444 104 101 NULL NULL NULL NULL
444 NULL 207 NULL NULL NULL NULL

query IIIIFII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       abs(a) as col2,
       d as col3,
       a+b*2+c*3+d*4 as col4,
       (a+b+c+d+e)/5 as col5,
       e as col6,
       a-b as col7
from t1
order by col1,col5,col6,col7,col4,col2,col3
----
111 245 248 2476 247.0 246 -4
222 127 128 1272 127.0 126 -2
222 138 136 1371 137.0 135 -1
222 142 140 1411 142.0 144 -1
222 191 190 1918 192.0 192 -3
222 216 217 2165 217.0 219 -2
222 220 222 2226 222.0 221 -3
222 121 122 1226 NULL NULL -3
333 107 108 1067 107.0 109 2
333 131 133 1325 132.0 132 1
333 182 183 1828 182.0 180 1
333 188 185 1861 187.0 189 2
333 199 196 1964 197.0 197 1
333 213 212 2125 212.0 210 2
333 229 226 2264 227.0 227 1
333 234 233 2323 232.0 230 2
333 159 NULL NULL NULL 157 1
333 168 NULL NULL NULL 165 1
333 153 NULL NULL NULL NULL 2
444 163 164 1622 162.0 162 3
444 174 171 1714 172.0 173 4
444 NULL 114 NULL NULL 110 NULL
444 115 116 NULL NULL 117 NULL
444 149 NULL NULL NULL 146 4
444 179 NULL NULL NULL 177 4
444 201 203 NULL NULL 204 NULL
444 239 238 NULL NULL 237 3
444 243 NULL NULL NULL NULL 3
444 104 101 NULL NULL NULL NULL
444 NULL 207 NULL NULL NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       abs(a) as col2
from t1
where c between b-2 and d+2
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       abs(a) as col2
from t1
where c between b-2 and d+2
order by col1,col2

query TIITIII
select (a+b+c+d+e)/5 as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2 as col3,
       e as col4,
       abs(b-c) as col5,
       c as col6,
       a-b as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
   and c>d
order by col6,col7,col4,col5,col2,col3,col1
----
NULL 1240 369 NULL 1 123 -3
132.0 1300 391 132 4 134 1
137.0 1390 416 135 2 137 -1
142.0 1430 428 144 2 141 -1
172.0 1700 514 173 2 172 4
182.0 364 544 180 3 184 1
187.0 376 560 189 1 187 2
NULL NULL NULL NULL 2 208 NULL
212.0 426 635 210 3 214 2
222.0 440 666 221 1 224 -3

query TIITIII
select (a+b+c+d+e)/5 as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2 as col3,
       e as col4,
       abs(b-c) as col5,
       c as col6,
       a-b as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
   and c>d
order by col7,col5,col6,col4,col2,col3,col1
----
NULL 1240 369 NULL 1 123 -3
222.0 440 666 221 1 224 -3
137.0 1390 416 135 2 137 -1
142.0 1430 428 144 2 141 -1
182.0 364 544 180 3 184 1
132.0 1300 391 132 4 134 1
187.0 376 560 189 1 187 2
212.0 426 635 210 3 214 2
172.0 1700 514 173 2 172 4
NULL NULL NULL NULL 2 208 NULL

query TIITIII
select (a+b+c+d+e)/5 as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2 as col3,
       e as col4,
       abs(b-c) as col5,
       c as col6,
       a-b as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c>d
   and c between b-2 and d+2
order by col6,col7,col4,col5,col2,col3,col1
----
NULL 1240 369 NULL 1 123 -3
132.0 1300 391 132 4 134 1
137.0 1390 416 135 2 137 -1
142.0 1430 428 144 2 141 -1
172.0 1700 514 173 2 172 4
182.0 364 544 180 3 184 1
187.0 376 560 189 1 187 2
NULL NULL NULL NULL 2 208 NULL
212.0 426 635 210 3 214 2
222.0 440 666 221 1 224 -3

query FIIIIII
select (a+b+c+d+e)/5 as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2 as col3,
       e as col4,
       abs(b-c) as col5,
       c as col6,
       a-b as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c>d
   and c between b-2 and d+2
order by col4,col6,col2,col7,col5,col3,col1
----
132.0 1300 391 132 4 134 1
137.0 1390 416 135 2 137 -1
142.0 1430 428 144 2 141 -1
172.0 1700 514 173 2 172 4
182.0 364 544 180 3 184 1
187.0 376 560 189 1 187 2
212.0 426 635 210 3 214 2
222.0 440 666 221 1 224 -3
NULL 1240 369 NULL 1 123 -3
NULL NULL NULL NULL 2 208 NULL

query IITIIIT
select b as col1,
       b-c as col2,
       e as col3,
       c as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a+b*2+c*3 as col6,
       a+b*2+c*3+d*4+e*5 as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c>d
order by col6,col7,col4,col5,col2,col3,col1
----
124 1 NULL 123 1240 738 NULL
130 -4 132 134 1300 793 1985
139 2 135 137 1390 827 2046
143 2 144 141 1430 851 2131
170 -2 173 172 1700 1030 2579
181 -3 180 184 364 1096 2728
186 -1 189 187 376 1121 2806
194 1 192 193 382 1158 2878
211 -3 210 214 426 1277 3175
223 -1 221 224 440 1338 3331
NULL NULL NULL 102 NULL NULL NULL
NULL NULL 117 119 NULL NULL NULL
206 -2 NULL 208 NULL NULL NULL

query IITIIIT
select b as col1,
       b-c as col2,
       e as col3,
       c as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a+b*2+c*3 as col6,
       a+b*2+c*3+d*4+e*5 as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c>d
order by col6,col1,col5,col7,col4,col2,col3
----
124 1 NULL 123 1240 738 NULL
130 -4 132 134 1300 793 1985
139 2 135 137 1390 827 2046
143 2 144 141 1430 851 2131
170 -2 173 172 1700 1030 2579
181 -3 180 184 364 1096 2728
186 -1 189 187 376 1121 2806
194 1 192 193 382 1158 2878
211 -3 210 214 426 1277 3175
223 -1 221 224 440 1338 3331
206 -2 NULL 208 NULL NULL NULL
NULL NULL NULL 102 NULL NULL NULL
NULL NULL 117 119 NULL NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       c as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2 as col5,
       d as col6,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col7
from t1
where c>d
   and (a>b-2 and a<b+2)
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       c as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2 as col5,
       d as col6,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col7
from t1
where c>d
   and (a>b-2 and a<b+2)
order by col4,col1,col5,col6,col3,col7,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b as col3,
       (a+b+c+d+e)/5 as col4
from t1
where (e>c or e<d)
   and c between b-2 and d+2
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b as col3,
       (a+b+c+d+e)/5 as col4
from t1
where (e>c or e<d)
   and c between b-2 and d+2
order by col4,col1,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b as col3,
       (a+b+c+d+e)/5 as col4
from t1
where c between b-2 and d+2
   and (e>c or e<d)
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b as col3,
       (a+b+c+d+e)/5 as col4
from t1
where c between b-2 and d+2
   and (e>c or e<d)
order by col2,col1,col4,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a-b as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a+b*2+c*3+d*4 as col5,
       (a+b+c+d+e)/5 as col6,
       a+b*2 as col7
from t1
where d not between 110 and 150
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a-b as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a+b*2+c*3+d*4 as col5,
       (a+b+c+d+e)/5 as col6,
       a+b*2 as col7
from t1
where d not between 110 and 150
order by col2,col5,col6,col7,col4,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where d not between 110 and 150
    or (a>b-2 and a<b+2)
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where d not between 110 and 150
    or (a>b-2 and a<b+2)
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col3,col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or d not between 110 and 150
    or (a>b-2 and a<b+2)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or d not between 110 and 150
    or (a>b-2 and a<b+2)
order by col2,col1,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where d not between 110 and 150
    or exists(select 1 from t1 as x where x.b<t1.b)
    or (a>b-2 and a<b+2)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where d not between 110 and 150
    or exists(select 1 from t1 as x where x.b<t1.b)
    or (a>b-2 and a<b+2)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       b-c as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4,
       c-d as col5,
       a+b*2 as col6,
       a as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3+d*4 as col1,
       b-c as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4,
       c-d as col5,
       a+b*2 as col6,
       a as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col4,col7,col5,col2,col3,col6

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2+c*3+d*4 as col2,
       a+b*2 as col3
from t1
where c between b-2 and d+2
    or (e>a and e<b)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2+c*3+d*4 as col2,
       a+b*2 as col3
from t1
where c between b-2 and d+2
    or (e>a and e<b)
order by col3,col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2+c*3+d*4 as col2,
       a+b*2 as col3
from t1
where (e>a and e<b)
    or c between b-2 and d+2
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select b as col1,
       a+b*2+c*3+d*4 as col2,
       a+b*2 as col3
from t1
where (e>a and e<b)
    or c between b-2 and d+2
order by col1,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       d as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       a+b*2+c*3+d*4 as col4,
       e as col5
from t1
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       d as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       a+b*2+c*3+d*4 as col4,
       e as col5
from t1
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       c-d as col3,
       abs(b-c) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       e as col6
from t1
where (a>b-2 and a<b+2)
    or b>c
    or a>b
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       c-d as col3,
       abs(b-c) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       e as col6
from t1
where (a>b-2 and a<b+2)
    or b>c
    or a>b
order by col4,col2,col1,col3,col5,col6

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       c-d as col3,
       abs(b-c) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       e as col6
from t1
where a>b
    or (a>b-2 and a<b+2)
    or b>c
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       c-d as col3,
       abs(b-c) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       e as col6
from t1
where a>b
    or (a>b-2 and a<b+2)
    or b>c
order by col4,col1,col5,col6,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       c-d as col3,
       abs(b-c) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       e as col6
from t1
where b>c
    or a>b
    or (a>b-2 and a<b+2)
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       c-d as col3,
       abs(b-c) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       e as col6
from t1
where b>c
    or a>b
    or (a>b-2 and a<b+2)
order by col1,col6,col5,col4,col2,col3

query IIIII
select e as col1,
       a-b as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       b as col4,
       abs(a) as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>a and e<b)
order by col4,col5,col2,col3,col1
----
192 -3 382 194 191
221 -3 440 223 220
246 -4 490 249 245

query IIIII
select e as col1,
       a-b as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       b as col4,
       abs(a) as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>a and e<b)
order by col2,col5,col4,col1,col3
----
246 -4 490 249 245
192 -3 382 194 191
221 -3 440 223 220

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       b-c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       e as col6
from t1
where c between b-2 and d+2
   and (e>c or e<d)
   and e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       b-c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       e as col6
from t1
where c between b-2 and d+2
   and (e>c or e<d)
   and e+d between a+b-10 and c+130
order by col1,col3,col4,col2,col6,col5

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       b-c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       e as col6
from t1
where c between b-2 and d+2
   and e+d between a+b-10 and c+130
   and (e>c or e<d)
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       b-c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       e as col6
from t1
where c between b-2 and d+2
   and e+d between a+b-10 and c+130
   and (e>c or e<d)
order by col4,col1,col6,col5,col2,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       b-c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       e as col6
from t1
where e+d between a+b-10 and c+130
   and (e>c or e<d)
   and c between b-2 and d+2
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       b-c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       e as col6
from t1
where e+d between a+b-10 and c+130
   and (e>c or e<d)
   and c between b-2 and d+2
order by col1,col6,col4,col2,col5,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       b-c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       e as col6
from t1
where (e>c or e<d)
   and c between b-2 and d+2
   and e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       b-c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       e as col6
from t1
where (e>c or e<d)
   and c between b-2 and d+2
   and e+d between a+b-10 and c+130
order by col5,col1,col2,col6,col4,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a as col3
from t1
where d>e
   and (e>a and e<b)
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a as col3
from t1
where d>e
   and (e>a and e<b)
order by col3,col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a as col3
from t1
where (e>a and e<b)
   and d>e
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2+c*3 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a as col3
from t1
where (e>a and e<b)
   and d>e
order by col3,col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       d as col2,
       (a+b+c+d+e)/5 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       c-d as col5
from t1
where (e>c or e<d)
    or c between b-2 and d+2
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       d as col2,
       (a+b+c+d+e)/5 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       c-d as col5
from t1
where (e>c or e<d)
    or c between b-2 and d+2
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       d as col2,
       (a+b+c+d+e)/5 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       c-d as col5
from t1
where c between b-2 and d+2
    or (e>c or e<d)
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       d as col2,
       (a+b+c+d+e)/5 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       c-d as col5
from t1
where c between b-2 and d+2
    or (e>c or e<d)
order by col1,col2,col4,col5,col3

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where c>d
order by col2,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where c>d
order by col1,col2

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       a+b*2+c*3 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where a>b
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a as col1,
       a+b*2+c*3 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where a>b
order by col1,col2,col3

query IIIIIIF
select a+b*2+c*3+d*4+e*5 as col1,
       a as col2,
       abs(b-c) as col3,
       c as col4,
       b as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6,
       (a+b+c+d+e)/5 as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1
----
2046 138 2 137 139 111 137.0
2131 142 2 141 143 111 142.0
3175 213 3 214 211 222 212.0
NULL 201 NULL 202 NULL 222 NULL
NULL 243 4 244 240 222 NULL
1612 107 1 106 105 333 107.0
1902 127 4 125 129 333 127.0
2432 163 1 161 160 333 162.0
2728 182 3 184 181 333 182.0
3260 216 3 215 218 333 217.0
NULL 115 NULL 119 NULL 333 NULL
NULL 121 1 123 124 333 NULL
1985 131 4 134 130 444 132.0
2806 188 1 187 186 444 187.0
2878 191 1 193 194 444 192.0
3331 220 1 224 223 444 222.0
3706 245 2 247 249 444 247.0
2579 174 2 172 170 555 172.0
2949 199 3 195 198 555 197.0
3399 229 3 225 228 555 227.0
3473 234 1 231 232 555 232.0
NULL 104 NULL 102 NULL 555 NULL
NULL NULL 1 113 112 555 NULL
NULL 149 2 147 145 555 NULL
NULL 153 1 150 151 555 NULL
NULL 159 3 155 158 555 NULL
NULL 168 1 166 167 555 NULL
NULL 179 1 176 175 555 NULL
NULL NULL 2 208 206 555 NULL
NULL 239 NULL NULL 236 555 NULL

query IIIIIIF
select a+b*2+c*3+d*4+e*5 as col1,
       a as col2,
       abs(b-c) as col3,
       c as col4,
       b as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6,
       (a+b+c+d+e)/5 as col7
from t1
order by col3,col6,col4,col7,col1,col5,col2
----
1612 107 1 106 105 333 107.0
NULL 121 1 123 124 333 NULL
2432 163 1 161 160 333 162.0
2806 188 1 187 186 444 187.0
2878 191 1 193 194 444 192.0
3331 220 1 224 223 444 222.0
NULL NULL 1 113 112 555 NULL
NULL 153 1 150 151 555 NULL
NULL 168 1 166 167 555 NULL
NULL 179 1 176 175 555 NULL
3473 234 1 231 232 555 232.0
2046 138 2 137 139 111 137.0
2131 142 2 141 143 111 142.0
3706 245 2 247 249 444 247.0
NULL 149 2 147 145 555 NULL
2579 174 2 172 170 555 172.0
NULL NULL 2 208 206 555 NULL
3175 213 3 214 211 222 212.0
2728 182 3 184 181 333 182.0
3260 216 3 215 218 333 217.0
NULL 159 3 155 158 555 NULL
2949 199 3 195 198 555 197.0
3399 229 3 225 228 555 227.0
NULL 243 4 244 240 222 NULL
1902 127 4 125 129 333 127.0
1985 131 4 134 130 444 132.0
NULL 201 NULL 202 NULL 222 NULL
NULL 115 NULL 119 NULL 333 NULL
NULL 104 NULL 102 NULL 555 NULL
NULL 239 NULL NULL 236 555 NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       a-b as col3,
       c as col4,
       (a+b+c+d+e)/5 as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select c-d as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       a-b as col3,
       c as col4,
       (a+b+c+d+e)/5 as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col5,col2,col4,col3,col1

query I
select a+b*2+c*3 as col1
from t1
order by col1
----
635
738
760
793
827
851
880
905
940
966
1000
1030
1057
1096
1121
1158
1180
1277
1297
1338
1360
1391
1455
1484
NULL
NULL
NULL
NULL
NULL
NULL

query I
select a+b*2+c*3 as col1
from t1
order by col1
----
635
738
760
793
827
851
880
905
940
966
1000
1030
1057
1096
1121
1158
1180
1277
1297
1338
1360
1391
1455
1484
NULL
NULL
NULL
NULL
NULL
NULL

query IIT
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       c-d as col3
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col2,col3,col1
----
444 358 NULL
333 364 1
333 376 2
222 382 3
333 398 -1
444 402 -1
333 426 2
222 432 -2
222 440 2
333 458 -1
333 468 -2
444 486 NULL
111 490 -1
333 1050 -2
444 1120 -1
222 1240 1
222 1290 -3
333 1300 1
222 1390 1
222 1430 1
444 1450 NULL
333 1510 NULL
333 1580 NULL
444 1600 -3
333 1670 NULL
444 1700 1
444 2360 NULL
444 NULL 1
444 NULL 1
444 NULL 3

query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       c-d as col3
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col3,col1,col2
----
222 1290 -3
444 1600 -3
222 432 -2
333 468 -2
333 1050 -2
111 490 -1
333 398 -1
333 458 -1
444 402 -1
444 1120 -1
222 1240 1
222 1390 1
222 1430 1
333 364 1
333 1300 1
444 1700 1
444 NULL 1
444 NULL 1
222 440 2
333 376 2
333 426 2
222 382 3
444 NULL 3
333 1510 NULL
333 1580 NULL
333 1670 NULL
444 358 NULL
444 486 NULL
444 1450 NULL
444 2360 NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3 as col4,
       d-e as col5,
       a+b*2+c*3+d*4 as col6,
       c as col7
from t1
where c>d
    or c between b-2 and d+2
order by col6,col7,col4,col5,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select d as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3 as col4,
       d-e as col5,
       a+b*2+c*3+d*4 as col6,
       c as col7
from t1
where c>d
    or c between b-2 and d+2
order by col5,col7,col6,col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       e as col3
from t1
order by col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       e as col3
from t1
order by col2,col3,col1

query I
select d as col1
from t1
where (e>a and e<b)
order by col1
----
190
222
248

query I
select d as col1
from t1
where (e>a and e<b)
order by col1
----
190
222
248

query II
select a-b as col1,
       d-e as col2
from t1
order by col2,col1
----
-1 -4
2 -4
-3 -2
-2 -2
4 -2
1 -1
1 -1
2 -1
NULL -1
NULL -1
-3 1
-1 1
1 1
3 1
-4 2
-2 2
2 2
3 2
1 3
2 3
NULL 4
-3 NULL
1 NULL
1 NULL
2 NULL
3 NULL
4 NULL
4 NULL
NULL NULL
NULL NULL

query II
select a-b as col1,
       d-e as col2
from t1
order by col1,col2
----
-4 2
-3 -2
-3 1
-3 NULL
-2 -2
-2 2
-1 -4
-1 1
1 -1
1 -1
1 1
1 3
1 NULL
1 NULL
2 -4
2 -1
2 2
2 3
2 NULL
3 1
3 2
3 NULL
4 -2
4 NULL
4 NULL
NULL -1
NULL -1
NULL 4
NULL NULL
NULL NULL

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where d not between 110 and 150
   and c between b-2 and d+2
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where d not between 110 and 150
   and c between b-2 and d+2
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where c between b-2 and d+2
   and d not between 110 and 150
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where c between b-2 and d+2
   and d not between 110 and 150
order by col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2 as col1,
       b-c as col2,
       c as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col2,col3,col1

# need to check the result later, currently just use ok to skip
onlyif todo
statement ok
select a+b*2 as col1,
       b-c as col2,
       c as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col4,col1,col3

