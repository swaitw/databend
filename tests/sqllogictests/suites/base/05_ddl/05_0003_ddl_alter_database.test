statement ok
DROP DATABASE IF EXISTS a

statement ok
DROP DATABASE IF EXISTS b

statement ok
DROP DATABASE IF EXISTS c

statement ok
DROP DATABASE IF EXISTS a2

statement ok
DROP DATABASE IF EXISTS b2

statement ok
CREATE DATABASE a

statement ok
CREATE DATABASE b

statement ok
use a;

statement ok
CREATE TABLE a.t1 (id int)

statement ok
INSERT INTO a.t1 VALUES (1)

statement ok
CREATE TABLE b.t2 (id int)

statement ok
INSERT INTO b.t2 VALUES (10)

statement error 1003
ALTER DATABASE c RENAME TO a

statement ok
ALTER DATABASE IF EXISTS c RENAME TO a

query T
SELECT name FROM system.databases where name = 'a' or name = 'b';
----
a
b

statement ok
ALTER DATABASE IF EXISTS c RENAME TO C

statement error 1003
ALTER DATABASE c RENAME TO C

# don't exist database c, so the result will be empty
query ok
SELECT * FROM system.databases where name = 'c'

# don't exist database c, so the result will be empty
statement ok
SELECT name FROM system.databases where name = 'c';

statement error 1002
ALTER DATABASE IF EXISTS system RENAME TO C

statement error 1002
ALTER DATABASE system RENAME TO C

statement error 2301
ALTER DATABASE a RENAME TO b

statement error 2301
ALTER DATABASE IF EXISTS a RENAME TO b

statement ok
ALTER DATABASE a RENAME TO a2

# check if change a to `a2` successfully
query T
SELECT name FROM system.databases where name = 'a2';
----
a2

query I
SELECT * FROM a2.t1
----
1

statement error 1002
ALTER DATABASE b RENAME TO system

statement error 1002
ALTER DATABASE IF EXISTS b RENAME TO system

query I
SELECT * FROM b.t2
----
10

statement ok
ALTER DATABASE default.b RENAME TO b2

query I
SELECT * FROM b2.t2
----
10

query T
SELECT name FROM system.databases where name = 'b2';
----
b2

statement ok
DROP DATABASE b2

statement ok
DROP DATABASE a2



